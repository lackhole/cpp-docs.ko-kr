---
title: COleControl 클래스
ms.date: 08/27/2018
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
ms.openlocfilehash: 97c605426ed0ac869714f0f83d4957f7f6ce7d87
ms.sourcegitcommit: 180f63704f6ddd07a4172a93b179cf0733fd952d
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 09/06/2019
ms.locfileid: "70741387"
---
# <a name="colecontrol-class"></a>COleControl 클래스

OLE 컨트롤을 개발할 수 있는 강력한 기본 클래스입니다.

## <a name="syntax"></a>구문

```
class COleControl : public CWnd
```

## <a name="members"></a>멤버

### <a name="public-constructors"></a>Public 생성자

|이름|Description|
|----------|-----------------|
|[COleControl::COleControl](#colecontrol)|`COleControl` 개체를 만듭니다.|

### <a name="public-methods"></a>Public 메서드

|이름|Description|
|----------|-----------------|
|[COleControl::AmbientAppearance](#ambientappearance)|컨트롤의 현재 모양을 검색 합니다.|
|[COleControl::AmbientBackColor](#ambientbackcolor)|앰비언트 BackColor 속성의 값을 반환 합니다.|
|[COleControl::AmbientDisplayName](#ambientdisplayname)|컨테이너에 지정 된 대로 컨트롤의 이름을 반환 합니다.|
|[COleControl::AmbientFont](#ambientfont)|앰비언트 글꼴 속성의 값을 반환 합니다.|
|[COleControl::AmbientForeColor](#ambientforecolor)|앰비언트 ForeColor 속성의 값을 반환 합니다.|
|[COleControl::AmbientLocaleID](#ambientlocaleid)|컨테이너의 로캘 ID를 반환 합니다.|
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|컨테이너에서 사용 하는 단위 형식을 반환 합니다.|
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|잡기 핸들을 표시 해야 하는지 여부를 결정 합니다.|
|[COleControl::AmbientShowHatching](#ambientshowhatching)|해칭에 표시 되어야 하는지 여부를 결정 합니다.|
|[COleControl::AmbientTextAlign](#ambienttextalign)|컨테이너에 지정 된 텍스트 맞춤의 형식을 반환 합니다.|
|[COleControl::AmbientUIDead](#ambientuidead)|컨트롤이 사용자 인터페이스 작업에 응답 해야 하는지 여부를 결정 합니다.|
|[COleControl::AmbientUserMode](#ambientusermode)|컨테이너의 모드를 결정 합니다.|
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|바인딩된 속성이 변경 되었음을 컨테이너에 알립니다.|
|[COleControl::BoundPropertyRequestEdit](#boundpropertyrequestedit)|속성 값을 편집할 수 있는 권한을 요청 합니다.|
|[COleControl::ClientToParent](#clienttoparent)|컨트롤의 원점을 기준으로 하는 점을 컨테이너의 원점에 상대적인 점으로 변환 합니다.|
|[COleControl::ClipCaretRect](#clipcaretrect)|컨트롤에 겹쳐진 캐럿 사각형을 조정 합니다.|
|[COleControl::ControlInfoChanged](#controlinfochanged)|컨트롤에서 처리 한 니모닉 집합이 변경 된 후이 함수를 호출 합니다.|
|[COleControl::DisplayError](#displayerror)|스톡 오류 이벤트를 컨트롤의 사용자에 게 표시 합니다.|
|[COleControl::DoClick](#doclick)|스톡 `DoClick` 메서드의 구현입니다.|
|[COleControl::DoPropExchange](#dopropexchange)|`COleControl` 개체의 속성을 serialize 합니다.|
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|Windows 컨트롤에서 서브클래싱된 OLE 컨트롤을 다시 그립니다.|
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|컨트롤에 대 한 간단한 프레임 지원을 사용 합니다.|
|[COleControl::ExchangeExtent](#exchangeextent)|컨트롤의 너비와 높이를 serialize 합니다.|
|[COleControl::ExchangeStockProps](#exchangestockprops)|컨트롤의 스톡 속성을 serialize 합니다.|
|[COleControl::ExchangeVersion](#exchangeversion)|컨트롤의 버전 번호를 serialize 합니다.|
|[COleControl::FireClick](#fireclick)|스톡 `Click` 이벤트를 발생 시킵니다.|
|[COleControl::FireDblClick](#firedblclick)|스톡 `DblClick` 이벤트를 발생 시킵니다.|
|[COleControl::FireError](#fireerror)|스톡 `Error` 이벤트를 발생 시킵니다.|
|[COleControl::FireEvent](#fireevent)|사용자 지정 이벤트를 발생 시킵니다.|
|[COleControl::FireKeyDown](#firekeydown)|스톡 `KeyDown` 이벤트를 발생 시킵니다.|
|[COleControl::FireKeyPress](#firekeypress)|스톡 `KeyPress` 이벤트를 발생 시킵니다.|
|[COleControl::FireKeyUp](#firekeyup)|스톡 `KeyUp` 이벤트를 발생 시킵니다.|
|[COleControl::FireMouseDown](#firemousedown)|스톡 `MouseDown` 이벤트를 발생 시킵니다.|
|[COleControl::FireMouseMove](#firemousemove)|스톡 `MouseMove` 이벤트를 발생 시킵니다.|
|[COleControl::FireMouseUp](#firemouseup)|스톡 `MouseUp` 이벤트를 발생 시킵니다.|
|[COleControl::FireReadyStateChange](#firereadystatechange)|컨트롤의 준비 상태가 변경 될 때 이벤트를 발생 시킵니다.|
|[COleControl::GetActivationPolicy](#getactivationpolicy)|인터페이스를 `IPointerInactive` 지 원하는 컨트롤의 기본 활성화 동작을 변경 합니다.|
|[COleControl::GetAmbientProperty](#getambientproperty)|지정 된 앰비언트 속성의 값을 반환 합니다.|
|[COleControl::GetAppearance](#getappearance)|스톡 모양 속성의 값을 반환 합니다.|
|[COleControl::GetBackColor](#getbackcolor)|Stock BackColor 속성의 값을 반환 합니다.|
|[COleControl::GetBorderStyle](#getborderstyle)|스톡 BorderStyle 속성의 값을 반환 합니다.|
|[COleControl::GetCapture](#getcapture)|창 없는 활성화 된 컨트롤 개체에 마우스 캡처가 있는지 여부를 확인 합니다.|
|[COleControl::GetClassID](#getclassid)|컨트롤의 OLE 클래스 ID를 검색 합니다.|
|[COleControl::GetClientOffset](#getclientoffset)|컨트롤의 사각형 영역 왼쪽 위 모퉁이와 해당 클라이언트 영역의 왼쪽 위 모퉁이 간 차이를 검색 합니다.|
|[COleControl::GetClientRect](#getclientrect)|컨트롤 클라이언트 영역의 크기를 검색 합니다.|
|[COleControl::GetClientSite](#getclientsite)|해당 컨테이너 내의 현재 클라이언트 사이트에 대 한 포인터 개체를 쿼리 합니다.|
|[COleControl::GetControlFlags](#getcontrolflags)|컨트롤 플래그 설정을 검색 합니다.|
|[COleControl::GetControlSize](#getcontrolsize)|OLE 컨트롤의 위치와 크기를 반환 합니다.|
|[COleControl::GetDC](#getdc)|창 없는 컨트롤의 컨테이너에서 장치 컨텍스트를 가져오는 방법을 제공 합니다.|
|[COleControl::GetEnabled](#getenabled)|스톡 Enabled 속성의 값을 반환 합니다.|
|[COleControl::GetExtendedControl](#getextendedcontrol)|컨테이너에 속한 확장 컨트롤 개체에 대 한 포인터를 검색 합니다.|
|[COleControl::GetFocus](#getfocus)|컨트롤에 포커스가 있는지 여부를 확인 합니다.|
|[COleControl::GetFont](#getfont)|스톡 글꼴 속성의 값을 반환 합니다.|
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|`CFontHolder` 개체의 메트릭을 반환 합니다.|
|[COleControl::GetForeColor](#getforecolor)|스톡 ForeColor 속성의 값을 반환 합니다.|
|[COleControl::GetHwnd](#gethwnd)|스톡 hWnd 속성의 값을 반환 합니다.|
|[COleControl::GetMessageString](#getmessagestring)|메뉴 항목에 대 한 상태 표시줄 텍스트를 제공 합니다.|
|[COleControl::GetNotSupported](#getnotsupported)|사용자가 컨트롤의 속성 값에 액세스할 수 없도록 합니다.|
|[COleControl::GetReadyState](#getreadystate)|컨트롤의 준비 상태를 반환 합니다.|
|[COleControl::GetRectInContainer](#getrectincontainer)|컨테이너를 기준으로 컨트롤의 사각형을 반환 합니다.|
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|스톡 글꼴 속성의 메트릭을 반환 합니다.|
|[COleControl::GetText](#gettext)|스톡 텍스트 또는 캡션 속성의 값을 반환 합니다.|
|[COleControl::GetWindowlessDropTarget](#getwindowlessdroptarget)|창 없는 컨트롤을 끌어서 놓기 작업의 대상으로 사용할 수 있도록를 재정의 합니다.|
|[COleControl::InitializeIIDs](#initializeiids)|컨트롤에서 사용 하는 Iid의 기본 클래스에 알립니다.|
|[COleControl::InternalGetFont](#internalgetfont)|스톡 글꼴 `CFontHolder` 속성에 대 한 개체를 반환 합니다.|
|[COleControl::InternalGetText](#internalgettext)|스톡 캡션 또는 텍스트 속성을 검색 합니다.|
|[COleControl::InternalSetReadyState](#internalsetreadystate)|컨트롤의 준비 상태를 설정 하 고 준비 상태 변경 이벤트를 발생 시킵니다.|
|[COleControl::InvalidateControl](#invalidatecontrol)|표시 된 컨트롤의 영역을 무효화 하 여 다시 그려야 합니다.|
|[COleControl::InvalidateRgn](#invalidatergn)|지정 된 영역 내에서 컨테이너 창의 클라이언트 영역을 무효화 합니다. 영역에서 창 없는 컨트롤을 다시 그리는 데 사용할 수 있습니다.|
|[COleControl::IsConvertingVBX](#isconvertingvbx)|OLE 컨트롤의 특수 한 로드를 허용 합니다.|
|[COleControl::IsModified](#ismodified)|컨트롤 상태가 변경 되었는지 여부를 확인 합니다.|
|[COleControl::IsOptimizedDraw](#isoptimizeddraw)|컨테이너가 현재 그리기 작업에 대해 최적화 된 그리기를 지원 하는지 여부를 나타냅니다.|
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|컨트롤이 Windows 컨트롤을 서브 클래스 하는지 여부를 확인 하기 위해 호출 됩니다.|
|[COleControl::Load](#load)|이전 비동기 데이터를 다시 설정 하 고 컨트롤의 비동기 속성에 대 한 새 로드를 시작 합니다.|
|[COleControl::LockInPlaceActive](#lockinplaceactive)|컨테이너에서 컨트롤을 비활성화할 수 있는지 여부를 결정 합니다.|
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|앰비언트 속성이 변경 되 면 호출 됩니다.|
|[COleControl::OnAppearanceChanged](#onappearancechanged)|스톡 모양 속성이 변경 될 때 호출 됩니다.|
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|스톡 BackColor 속성이 변경 될 때 호출 됩니다.|
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|스톡 BorderStyle 속성이 변경 될 때 호출 됩니다.|
|[COleControl::OnClick](#onclick)|스톡 클릭 이벤트를 발생 시키기 위해 호출 됩니다.|
|[COleControl::OnClose](#onclose)|호출 된 컨트롤 `IOleControl::Close` 에 알립니다.|
|[COleControl::OnDoVerb](#ondoverb)|컨트롤 동사가 실행 된 후에 호출 됩니다.|
|[COleControl::OnDraw](#ondraw)|컨트롤이 자체적으로 다시 그리도록 요청 될 때 호출 됩니다.|
|[COleControl::OnDrawMetafile](#ondrawmetafile)|메타 파일 장치 컨텍스트를 사용 하 여 컨트롤을 다시 그리도록 요청할 때 컨테이너에 의해 호출 됩니다.|
|[COleControl::OnEdit](#onedit)|OLE 컨트롤을 UI 활성화 하기 위해 컨테이너에 의해 호출 됩니다.|
|[COleControl::OnEnabledChanged](#onenabledchanged)|스톡 Enabled 속성이 변경 될 때 호출 됩니다.|
|[COleControl::OnEnumVerbs](#onenumverbs)|컨트롤의 동사를 열거 하기 위해 컨테이너에 의해 호출 됩니다.|
|[COleControl::OnEventAdvise](#oneventadvise)|컨트롤에서 이벤트 처리기가 연결 되거나 연결이 끊어지면 호출 됩니다.|
|[COleControl::OnFontChanged](#onfontchanged)|스톡 글꼴 속성이 변경 될 때 호출 됩니다.|
|[COleControl::OnForeColorChanged](#onforecolorchanged)|스톡 ForeColor 속성이 변경 될 때 호출 됩니다.|
|[COleControl::OnFreezeEvents](#onfreezeevents)|컨트롤의 이벤트가 고정 되거나 고정 되지 않은 경우 호출 됩니다.|
|[COleControl::OnGetColorSet](#ongetcolorset)|호출 된 컨트롤 `IOleObject::GetColorSet` 에 알립니다.|
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|니모닉 정보를 컨테이너에 제공 합니다.|
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|속성 값을 나타내는 문자열을 가져오기 위해 호출 됩니다.|
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|컨테이너 메뉴와 병합 될 컨트롤의 메뉴에 대 한 핸들을 요청 합니다.|
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|제안 된 크기 및 범위 모드와 가장 가까운 컨트롤의 표시 크기를 검색 하려면를 재정의 합니다.|
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|속성의 가능한 값을 나타내는 문자열을 반환 합니다.|
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|미리 정의 된 문자열에 해당 하는 값을 반환 합니다.|
|[COleControl::OnGetViewExtent](#ongetviewextent)|를 재정의 하 여 컨트롤의 표시 영역 크기를 검색 합니다 (2 패스 그리기를 사용 하도록 설정 하는 데 사용할 수 있음).|
|[COleControl::OnGetViewRect](#ongetviewrect)|컨트롤의 크기를 특정 위치에서 시작 하는 사각형으로 변환 하려면를 재정의 합니다.|
|[COleControl::OnGetViewStatus](#ongetviewstatus)|컨트롤의 뷰 상태를 검색 하려면를 재정의 합니다.|
|[COleControl::OnHideToolBars](#onhidetoolbars)|컨트롤이 UI 비활성화 될 때 컨테이너에 의해 호출 됩니다.|
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|마우스 포인터 아래에 있는 비활성 컨트롤의 컨테이너가 WM_MOUSEMOVE 메시지를 컨트롤에 전달 하도록 하려면를 재정의 합니다.|
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|마우스 포인터 아래에 있는 비활성 컨트롤의 컨테이너가 WM_SETCURSOR 메시지를 컨트롤에 전달 하도록 하려면를 재정의 합니다.|
|[COleControl::OnKeyDownEvent](#onkeydownevent)|스톡 KeyDown 이벤트가 발생 한 후에 호출 됩니다.|
|[COleControl::OnKeyPressEvent](#onkeypressevent)|스톡 KeyPress 이벤트가 발생 한 후에 호출 됩니다.|
|[COleControl::OnKeyUpEvent](#onkeyupevent)|스톡 KeyUp 이벤트가 발생 한 후에 호출 됩니다.|
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|속성을 편집 하는 데 사용할 속성 페이지를 나타냅니다.|
|[COleControl::OnMnemonic](#onmnemonic)|컨트롤의 니모닉 키를 누르면 호출 됩니다.|
|[COleControl::OnProperties](#onproperties)|컨트롤의 "Properties" 동사가 호출 될 때 호출 됩니다.|
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|컨트롤의 디스플레이가 지정 된 지점과 겹치는 지 여부를 쿼리하려면를 재정의 합니다.|
|[COleControl::OnQueryHitRect](#onqueryhitrect)|컨트롤의 표시가 지정 된 사각형의 모든 점에서 겹치는 지 여부를 쿼리하려면를 재정의 합니다.|
|[COleControl::OnRenderData](#onrenderdata)|지정 된 형식의 데이터를 검색 하기 위해 프레임 워크에서 호출 됩니다.|
|[COleControl::OnRenderFileData](#onrenderfiledata)|지정 된 형식의 파일에서 데이터를 검색 하기 위해 프레임 워크에서 호출 됩니다.|
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|지정 된 형식의 전역 메모리에서 데이터를 검색 하기 위해 프레임 워크에서 호출 됩니다.|
|[COleControl::OnResetState](#onresetstate)|컨트롤의 속성을 기본값으로 다시 설정 합니다.|
|[COleControl::OnSetClientSite](#onsetclientsite)|호출 된 컨트롤 `IOleControl::SetClientSite` 에 알립니다.|
|[COleControl::OnSetData](#onsetdata)|컨트롤의 데이터를 다른 값으로 바꿉니다.|
|[COleControl::OnSetExtent](#onsetextent)|컨트롤의 범위가 변경 된 후에 호출 됩니다.|
|[COleControl::OnSetObjectRects](#onsetobjectrects)|컨트롤의 차원이 변경 된 후에 호출 됩니다.|
|[COleControl::OnShowToolBars](#onshowtoolbars)|컨트롤의 UI가 활성화 되 면 호출 됩니다.|
|[COleControl::OnTextChanged](#ontextchanged)|스톡 텍스트 또는 캡션 속성이 변경 될 때 호출 됩니다.|
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|창 없는 컨트롤의 창 메시지 (마우스 및 키보드 메시지 제외)를 처리 합니다.|
|[COleControl::ParentToClient](#parenttoclient)|컨테이너의 원점에 상대적인 지점을 컨트롤의 원점에 상대적인 점으로 변환 합니다.|
|[COleControl::PostModalDialog](#postmodaldialog)|모달 대화 상자가 닫 혔 음을 컨테이너에 알립니다.|
|[COleControl::PreModalDialog](#premodaldialog)|모달 대화 상자가 표시 될 지를 컨테이너에 알립니다.|
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|컨트롤의 창을 소멸 하 고 다시 만듭니다.|
|[COleControl::Refresh](#refresh)|컨트롤의 모양을 강제로 다시 칠합니다.|
|[COleControl::ReleaseCapture](#releasecapture)|마우스 캡처를 해제 합니다.|
|[COleControl::ReleaseDC](#releasedc)|창 없는 컨트롤의 컨테이너에 대 한 디스플레이 장치 컨텍스트를 해제 합니다.|
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|컨트롤 창의 부모를 다시 설정 합니다.|
|[COleControl::ResetStockProps](#resetstockprops)|스톡 `COleControl` 속성을 기본값으로 초기화 합니다.|
|[COleControl::ResetVersion](#resetversion)|버전 번호를 지정 된 값으로 초기화 합니다.|
|[COleControl::ScrollWindow](#scrollwindow)|창 없는 컨트롤에서 내부 활성 이미지 안에 있는 영역을 화면에 스크롤할 수 있도록 합니다.|
|[COleControl::SelectFontObject](#selectfontobject)|장치 컨텍스트에 사용자 지정 글꼴 속성을 선택 합니다.|
|[COleControl::SelectStockFont](#selectstockfont)|장치 컨텍스트에서 스톡 글꼴 속성을 선택 합니다.|
|[COleControl::SerializeExtent](#serializeextent)|컨트롤의 표시 공간을 serialize 하거나 초기화 합니다.|
|[COleControl::SerializeStockProps](#serializestockprops)|스톡 속성을 `COleControl` serialize 하거나 초기화 합니다.|
|[COleControl::SerializeVersion](#serializeversion)|컨트롤의 버전 정보를 serialize 하거나 초기화 합니다.|
|[COleControl::SetAppearance](#setappearance)|스톡 모양 속성의 값을 설정 합니다.|
|[COleControl::SetBackColor](#setbackcolor)|Stock BackColor 속성의 값을 설정 합니다.|
|[COleControl::SetBorderStyle](#setborderstyle)|스톡 BorderStyle 속성의 값을 설정 합니다.|
|[COleControl::SetCapture](#setcapture)|컨트롤의 컨테이너 창이 컨트롤을 대신 하 여 마우스 캡처를 소유 하도록 합니다.|
|[COleControl::SetControlSize](#setcontrolsize)|OLE 컨트롤의 위치와 크기를 설정 합니다.|
|[COleControl::SetEnabled](#setenabled)|스톡 Enabled 속성의 값을 설정 합니다.|
|[COleControl::SetFocus](#setfocus)|컨트롤의 컨테이너 창이 컨트롤의 대신 입력 포커스를 소유 하 게 합니다.|
|[COleControl::SetFont](#setfont)|스톡 글꼴 속성의 값을 설정 합니다.|
|[COleControl::SetForeColor](#setforecolor)|스톡 ForeColor 속성의 값을 설정 합니다.|
|[COleControl::SetInitialSize](#setinitialsize)|컨테이너에 처음 표시 될 때 OLE 컨트롤의 크기를 설정 합니다.|
|[COleControl::SetModifiedFlag](#setmodifiedflag)|컨트롤의 수정 된 상태를 변경 합니다.|
|[COleControl::SetNotPermitted](#setnotpermitted)|편집 요청이 실패 했음을 나타냅니다.|
|[COleControl::SetNotSupported](#setnotsupported)|사용자가 컨트롤의 속성 값을 수정 하지 못하도록 합니다.|
|[COleControl::SetRectInContainer](#setrectincontainer)|컨테이너를 기준으로 컨트롤의 사각형을 설정 합니다.|
|[COleControl::SetText](#settext)|스톡 텍스트 또는 캡션 속성의 값을 설정 합니다.|
|[COleControl::ThrowError](#throwerror)|OLE 컨트롤에서 오류가 발생 했음을 나타냅니다.|
|[COleControl::TransformCoords](#transformcoords)|컨테이너와 컨트롤 간의 좌표 값을 변환 합니다.|
|[COleControl::TranslateColor](#translatecolor)|OLE_COLOR 값을 COLORREF 값으로 변환 합니다.|
|[COleControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|다음에 컨트롤이 로드 될 때 앰비언트 속성을 사용할 수 있는지 여부를 결정 합니다.|
|[COleControl::WindowProc](#windowproc)|`COleControl` 개체에 대 한 Windows 프로시저를 제공 합니다.|

### <a name="protected-methods"></a>Protected 메서드

|이름|설명|
|----------|-----------------|
|[COleControl::DrawContent](#drawcontent)|컨트롤의 모양을 업데이트 해야 할 때 프레임 워크에서 호출 됩니다.|
|[COleControl::DrawMetafile](#drawmetafile)|메타 파일 장치 컨텍스트를 사용할 때 프레임 워크에서 호출 됩니다.|
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|자동화 메서드 호출을 사용 합니다.|
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|컨트롤에서 지 원하는 데이터 형식 목록을 초기화 하기 위해 프레임 워크에서 호출 됩니다.|

## <a name="remarks"></a>설명

에서 `CWnd`파생 되는이 클래스는 Windows 창 개체의 모든 기능과 OLE 관련 추가 기능 (예: 이벤트 발생, 메서드 및 속성을 지 원하는 기능)을 상속 합니다.

Ole 컨트롤을 OLE 컨테이너 응용 프로그램에 삽입 하 고 이벤트 발생의 양방향 시스템을 사용 하 고 컨테이너에 메서드 및 속성을 노출 하 여 컨테이너와 통신할 수 있습니다. 표준 OLE 컨테이너는 OLE 컨트롤의 기본 기능만 지원 합니다. OLE 컨트롤의 확장 기능을 지원할 수 없습니다. 이벤트는 컨트롤에서 수행 되는 특정 작업의 결과로 이벤트가 컨테이너에 전송 될 때 발생 합니다. 그러면 컨테이너는 C++ 클래스의 멤버 함수 및 데이터 멤버와 유사한 메서드 및 속성의 노출 된 집합을 사용 하 여 컨트롤과 통신 합니다. 이 방법을 통해 개발자는 컨트롤의 모양을 제어 하 고 특정 작업이 발생할 때 컨테이너에 알릴 수 있습니다.

## <a name="windowless-controls"></a>창 없는 컨트롤

OLE 컨트롤은 창 없이 내부 활성 상태로 사용할 수 있습니다. 창 없는 컨트롤에는 상당한 이점이 있습니다.

- 창 없는 컨트롤은 투명 하 고 사각형이 아닐 수 있습니다.

- 창 없는 컨트롤은 개체의 인스턴스 크기와 생성 시간을 줄입니다.

컨트롤에는 창이 필요 하지 않습니다. 창에서 제공 하는 서비스는 단일 공유 창 (일반적으로 컨테이너의) 및 디스패치 코드를 통해 쉽게 제공할 수 있습니다. 창에 대 한 대부분은 개체에 불필요 하 게 복잡 합니다.

창 없는 활성화를 사용 하는 경우 창이 있는 컨테이너는 컨트롤의 자체 창에서 제공 하는 서비스를 제공 해야 합니다. 예를 들어 컨트롤에서 키보드 포커스를 쿼리하거나 마우스 캡처를 쿼리하거나 장치 컨텍스트를 가져와야 하는 경우 이러한 작업은 컨테이너에 의해 관리 됩니다. 창 `COleControl` 없는 작업 멤버 함수는 컨테이너에서 이러한 작업을 호출 합니다.

창 없는 활성화를 사용 하도록 설정 하면 컨테이너는 입력 메시지를 컨트롤의 `IOleInPlaceObjectWindowless` 인터페이스 (창 없는 지원에 대 한 [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) 확장)에 위임 합니다. `COleControl`이 인터페이스를 구현 하면 마우스 좌표를 적절 하 게 조정한 후 컨트롤의 메시지 맵을 통해 이러한 메시지를 디스패치합니다. 메시지 맵에 해당 항목을 추가 하 여 일반 창 메시지와 같은 이러한 메시지를 처리할 수 있습니다.

창 없는 컨트롤에서는 해당 `COleControl` `CWnd` 멤버 함수 또는 관련 Windows API 함수 대신 항상 멤버 함수를 사용 해야 합니다.

OLE 컨트롤 개체는 활성 상태가 되는 경우에만 창을 만들 수도 있지만, 비활성-활성 전환에 필요한 작업 양이 중단 되 고 전환 속도가 중단 됩니다. 이 문제가 발생 하는 경우가 있습니다. 예를 들어 텍스트 상자의 표를 살펴보세요. 열을 통해 cursoring 하는 경우 각 컨트롤이 내부 활성화 된 후 비활성화 되어 있어야 합니다. 비활성/활성 전환 속도는 스크롤 속도에 직접적인 영향을 줍니다.

OLE 컨트롤 프레임 워크를 개발 하는 방법에 대 한 자세한 내용은 [MFC ActiveX 컨트롤](../../mfc/mfc-activex-controls.md) 및 [개요 문서를 참조 하세요. MFC ActiveX 컨트롤 프로그램](../../mfc/reference/mfc-activex-control-wizard.md)만들기 창 없는 컨트롤 및 깜빡임 없는 컨트롤 [을 포함 하 여 OLE 컨트롤을 최적화 하는 방법에 대 한 자세한 내용은 MFC ActiveX 컨트롤: 최적화](../../mfc/mfc-activex-controls-optimization.md).

## <a name="inheritance-hierarchy"></a>상속 계층 구조

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>요구 사항

**헤더:** afxctl

##  <a name="ambientbackcolor"></a>  COleControl::AmbientBackColor

앰비언트 BackColor 속성의 값을 반환 합니다.

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>반환 값

컨테이너의 앰비언트 BackColor 속성 (있는 경우)의 현재 값입니다. 속성이 지원 되지 않는 경우이 함수는 시스템 정의 Windows 배경색을 반환 합니다.

### <a name="remarks"></a>설명

앰비언트 BackColor 속성은 모든 컨트롤에 사용할 수 있으며 컨테이너에 의해 정의 됩니다. 컨테이너는이 속성을 지 원하는 데 필요 하지 않습니다.

##  <a name="ambientdisplayname"></a>  COleControl::AmbientDisplayName

컨테이너를 컨트롤에 할당 한 이름은 사용자에 게 표시 되는 오류 메시지에서 사용할 수 있습니다.

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>반환 값

OLE 컨트롤의 이름입니다. 기본값은 길이가 0 인 문자열입니다.

### <a name="remarks"></a>설명

컨테이너는이 속성을 지 원하는 데 필요 하지 않습니다.

##  <a name="ambientfont"></a>  COleControl::AmbientFont

앰비언트 글꼴 속성의 값을 반환 합니다.

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>반환 값

컨테이너의 앰비언트 글꼴 디스패치 인터페이스에 대 한 포인터입니다. 기본값은 NULL입니다. 반환 값이 NULL이 아닌 경우 [IUnknown:: Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) 멤버 함수를 호출 하 여 글꼴을 해제 해야 합니다.

### <a name="remarks"></a>설명

앰비언트 글꼴 속성은 컨테이너에서 정의 되며 모든 컨트롤에서 사용할 수 있습니다. 컨테이너는이 속성을 지 원하는 데 필요 하지 않습니다.

##  <a name="ambientforecolor"></a>  COleControl::AmbientForeColor

앰비언트 ForeColor 속성의 값을 반환 합니다.

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>반환 값

컨테이너의 앰비언트 ForeColor 속성의 현재 값입니다 (있는 경우). 지원 되지 않는 경우이 함수는 시스템 정의 Windows 텍스트 색을 반환 합니다.

### <a name="remarks"></a>설명

앰비언트 ForeColor 속성은 모든 컨트롤에 사용할 수 있으며 컨테이너에 의해 정의 됩니다. 컨테이너는이 속성을 지 원하는 데 필요 하지 않습니다.

##  <a name="ambientlocaleid"></a>  COleControl::AmbientLocaleID

컨테이너의 로캘 ID를 반환 합니다.

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>반환 값

컨테이너의 LocaleID 속성 값입니다 (있는 경우). 이 속성이 지원 되지 않는 경우이 함수는 0을 반환 합니다.

### <a name="remarks"></a>설명

컨트롤은 LocaleID를 사용 하 여 특정 로캘의 사용자 인터페이스를 수정할 수 있습니다. 컨테이너는이 속성을 지 원하는 데 필요 하지 않습니다.

##  <a name="ambientappearance"></a>  COleControl::AmbientAppearance

컨트롤 개체에 대 한 현재 모양 설정을 검색 합니다.

```
short AmbientAppearance();
```

### <a name="return-value"></a>반환 값

컨트롤의 모양입니다.

- **0** 평면 모양

- **1** 3d 모양

### <a name="remarks"></a>설명

이 함수를 호출 하 여 컨트롤에 대 한 DISPID_AMBIENT_APPEARANCE 속성의 현재 값을 검색 합니다.

##  <a name="ambientscaleunits"></a>  COleControl::AmbientScaleUnits

컨테이너에서 사용 하는 단위 형식을 반환 합니다.

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>반환 값

컨테이너의 앰비언트 ScaleUnits을 포함 하는 문자열입니다. 이 속성이 지원 되지 않는 경우이 함수는 길이가 0 인 문자열을 반환 합니다.

### <a name="remarks"></a>설명

컨테이너의 앰비언트 ScaleUnits 속성은 트윕 또는 센티미터와 같이 선택한 단위로 레이블이 지정 된 위치 또는 차원을 표시 하는 데 사용할 수 있습니다. 컨테이너는이 속성을 지 원하는 데 필요 하지 않습니다.

##  <a name="ambientshowgrabhandles"></a>  COleControl::AmbientShowGrabHandles

컨테이너에서 컨트롤이 활성화 될 때 자체에 대 한 잡기 핸들을 표시할 수 있는지 여부를 결정 합니다.

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>반환 값

잡기 핸들을 표시 해야 하는 경우 0이 아닙니다. 그렇지 않으면 0입니다. 이 속성이 지원 되지 않는 경우이 함수는 0이 아닌 값을 반환 합니다.

### <a name="remarks"></a>설명

컨테이너는이 속성을 지 원하는 데 필요 하지 않습니다.

##  <a name="ambientshowhatching"></a>  COleControl::AmbientShowHatching

UI가 활성화 될 때 컨테이너를 사용 하 여 컨트롤에서 빗살 무늬 패턴을 표시할지 여부를 결정 합니다.

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>반환 값

빗살 무늬 패턴을 표시 해야 하는 경우 0이 아닙니다. 그렇지 않으면 0입니다. 이 속성이 지원 되지 않는 경우이 함수는 0이 아닌 값을 반환 합니다.

### <a name="remarks"></a>설명

컨테이너는이 속성을 지 원하는 데 필요 하지 않습니다.

##  <a name="ambienttextalign"></a>  COleControl::AmbientTextAlign

컨트롤 컨테이너에서 선호 하는 앰비언트 텍스트 맞춤을 결정 합니다.

```
short AmbientTextAlign();
```

### <a name="return-value"></a>반환 값

컨테이너의 앰비언트 TextAlign 속성의 상태입니다. 이 속성이 지원 되지 않는 경우이 함수는 0을 반환 합니다.

다음은 유효한 반환 값의 목록입니다.

|반환 값|의미|
|------------------|-------------|
|0|일반 맞춤 (오른쪽의 숫자, 왼쪽의 텍스트)|
|1|왼쪽 맞춤|
|2|가운데 맞춤|
|3|오른쪽 맞춤|

### <a name="remarks"></a>설명

이 속성은 모든 포함 된 컨트롤에서 사용할 수 있으며 컨테이너에 의해 정의 됩니다. 컨테이너는이 속성을 지 원하는 데 필요 하지 않습니다.

##  <a name="ambientuidead"></a>  COleControl::AmbientUIDead

컨테이너에서 컨트롤이 사용자 인터페이스 작업에 응답 하도록 할지 여부를 결정 합니다.

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>반환 값

컨트롤이 사용자 인터페이스 작업에 응답 해야 하는 경우 0이 아닙니다. 그렇지 않으면 0입니다. 이 속성이 지원 되지 않는 경우이 함수는 0을 반환 합니다.

### <a name="remarks"></a>설명

예를 들어, 컨테이너는 디자인 모드에서이를 TRUE로 설정할 수 있습니다.

##  <a name="ambientusermode"></a>  COleControl::AmbientUserMode

컨테이너가 디자인 모드 또는 사용자 모드에 있는지 여부를 확인 합니다.

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>반환 값

컨테이너가 사용자 모드에 있는 경우 0이 아닌 값입니다. 그렇지 않으면 0 (디자인 모드)입니다. 이 속성이 지원 되지 않는 경우이 함수는 TRUE를 반환 합니다.

### <a name="remarks"></a>설명

예를 들어, 컨테이너는 디자인 모드에서이를 FALSE로 설정할 수 있습니다.

##  <a name="boundpropertychanged"></a>  COleControl::BoundPropertyChanged

바인딩된 속성 값이 변경 되었음을 신호로 보냅니다.

```
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>매개 변수

*dispid*<br/>
컨트롤의 바인딩된 속성에 대 한 디스패치 ID입니다.

### <a name="remarks"></a>설명

속성 집합 메서드를 통해 변경이 수행 되지 않은 경우에도 속성 값이 변경 될 때마다이 메서드를 호출 해야 합니다. 멤버 변수에 매핑되는 바인딩된 속성에 대해 특히 주의 해야 합니다. 멤버 변수가 변경 될 때마다를 `BoundPropertyChanged` 호출 해야 합니다.

##  <a name="boundpropertyrequestedit"></a>  COleControl::BoundPropertyRequestEdit

컨트롤에서 제공 하 `IPropertyNotifySink` 는 바인딩된 속성 값을 변경 하기 위해 인터페이스에서 권한을 요청 합니다.

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>매개 변수

*dispid*<br/>
컨트롤의 바인딩된 속성에 대 한 디스패치 ID입니다.

### <a name="return-value"></a>반환 값

변경이 허용 되는 경우 0이 아닙니다. 그렇지 않으면 0입니다. 기본값은 0이 아닙니다.

### <a name="remarks"></a>설명

권한이 거부 되 면 컨트롤은 속성 변경의 값을 허용 하지 않아야 합니다. 이렇게 하려면 속성 값을 변경 하려고 시도한 동작을 무시 하거나 실패 합니다.

##  <a name="clienttoparent"></a>  COleControl::ClientToParent

*Ppoint* 의 좌표를 부모 좌표로 변환 합니다.

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>매개 변수

*lprcBounds*<br/>
컨테이너에 있는 OLE 컨트롤의 범위에 대 한 포인터입니다. 클라이언트 영역이 아니라 테두리 및 스크롤 막대를 비롯 한 전체 컨트롤의 영역입니다.

*pPoint*<br/>
부모 (컨테이너)의 좌표로 변환할 OLE 클라이언트 영역에 대 한 포인터입니다.

### <a name="remarks"></a>설명

입력 된 *Ppoint* 는 OLE 컨트롤의 클라이언트 영역 (컨트롤의 클라이언트 영역 왼쪽 위 모퉁이)의 출처를 기준으로 합니다. 출력 *Ppoint* 는 부모의 원점 (컨테이너의 왼쪽 위 모퉁이)에 상대적입니다.

##  <a name="clipcaretrect"></a>  COleControl::ClipCaretRect

는 겹치는 불투명 개체가 전부 또는 부분적으로 적용 되는 경우 캐럿 사각형을 조정 합니다.

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>매개 변수

*lpRect*<br/>
입력 시 조정할 캐럿 영역을 포함 하는 [RECT](/windows/win32/api/windef/ns-windef-rect) 구조체에 대 한 포인터입니다. 출력에서 조정 된 캐럿 영역 또는 캐럿 사각형이 완전히 적용 되는 경우 NULL입니다.

### <a name="return-value"></a>반환 값

성공하면 0이 아니고, 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

캐럿은 일반적으로 텍스트 또는 그래픽이 삽입 되는 위치를 나타내는 깜박이는 선, 블록 또는 비트맵입니다.

창 없는 개체는 겹치는 개체에 의해 캐럿이 부분적으로 숨겨지는지 아니면 완전히 숨겨지는지를 먼저 확인 하지 않고 캐럿을 안전 하 게 표시할 수 없습니다. 가능 하 게 하기 위해 개체는를 사용 `ClipCaretRect` 하 여 캐럿이 조정 영역에 맞게 조정 (축소) 되도록 할 수 있습니다.

캐럿을 만드는 개체는 캐럿 사각형을에 전송 `ClipCaretRect` 하 고 캐럿에 대해 조정 된 사각형을 사용 해야 합니다. 캐럿이 완전히 숨겨지면이 메서드는 FALSE를 반환 하 고이 경우에는 캐럿을 표시 하지 않아야 합니다.

##  <a name="colecontrol"></a>  COleControl::COleControl

`COleControl` 개체를 생성합니다.

```
COleControl();
```

### <a name="remarks"></a>설명

이 함수는 일반적으로 직접 호출 되지 않습니다. 대신, OLE 컨트롤은 일반적으로 해당 클래스 팩터리에서 생성 됩니다.

##  <a name="controlinfochanged"></a>  COleControl::ControlInfoChanged

컨트롤에서 지 원하는 니모닉 집합이 변경 되 면이 함수를 호출 합니다.

```
void ControlInfoChanged();
```

### <a name="remarks"></a>설명

이 알림이 수신 되 면 컨트롤의 컨테이너는 [IOleControl:: GetControlInfo](/windows/win32/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo)를 호출 하 여 새 니모닉 집합을 가져옵니다. 컨테이너는이 알림에 응답 하는 데 필요 하지 않습니다.

##  <a name="displayerror"></a>  COleControl::DisplayError

이벤트 처리기가 오류 표시를 표시 하지 않는 한 스톡 오류 이벤트가 처리 된 후 프레임 워크에서 호출 됩니다.

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>매개 변수

*scode*<br/>
보고할 상태 코드 값입니다. 가능한 코드의 전체 목록은 ActiveX 컨트롤 문서 [를 참조 하세요. 고급 항목](../../mfc/mfc-activex-controls-advanced-topics.md)

*lpszDescription*<br/>
보고 되는 오류에 대 한 설명입니다.

*lpszSource*<br/>
오류를 생성 하는 모듈의 이름입니다 (일반적으로 OLE 컨트롤 모듈의 이름).

*lpszHelpFile*<br/>
오류에 대 한 설명이 포함 된 도움말 파일의 이름입니다.

*nHelpID*<br/>
보고 되는 오류의 도움말 컨텍스트 ID입니다.

### <a name="remarks"></a>설명

기본 동작은 *lpszDescription*에 포함 된 오류에 대 한 설명을 포함 하는 메시지 상자를 표시 합니다.

오류가 표시 되는 방식을 사용자 지정 하려면이 함수를 재정의 합니다.

##  <a name="doclick"></a>  COleControl::DoClick

컨트롤에서 마우스 클릭 동작을 시뮬레이션 합니다.

```
void DoClick();
```

### <a name="remarks"></a>설명

재정의할 `COleControl::OnClick` 수 있는 멤버 함수가 호출 되 고 컨트롤에서 지 원하는 경우에는 스톡 Click 이벤트가 발생 합니다.

이 함수는 `COleControl` 기본 클래스에서 doclick 이라는 스톡 메서드로 지원 됩니다. 자세한 내용은 ActiveX 컨트롤 문서 [를 참조 하세요. 메서드](../../mfc/mfc-activex-controls-methods.md).

##  <a name="dopropexchange"></a>  COleControl::DoPropExchange

스트림 또는 속성 집합과 같은 영구 저장소 표현의 컨트롤을 로드 하거나 저장할 때 프레임 워크에서 호출 됩니다.

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>매개 변수

*pPX*<br/>
`CPropExchange` 개체에 대한 포인터입니다. 프레임 워크는 해당 방향을 포함 하 여 속성 교환의 컨텍스트를 설정 하기 위해이 개체를 제공 합니다.

### <a name="remarks"></a>설명

이 함수는 일반적으로 **PX_** 함수 패밀리를 호출 하 여 OLE 컨트롤의 특정 사용자 정의 속성을 로드 하거나 저장 합니다.

컨트롤 마법사를 사용 하 여 OLE 컨트롤 프로젝트를 만든 경우이 함수의 재정의 된 버전은에서 `COleControl` 지 원하는 스톡 속성을 기본 클래스 `COleControl::DoPropExchange`함수에 대 한 호출로 serialize 합니다. OLE 컨트롤에 사용자 정의 속성을 추가 하는 경우이 함수를 수정 하 여 새 속성을 serialize 해야 합니다. Serialization에 대 한 자세한 내용은 ActiveX 컨트롤 문서 [를 참조 하세요. Serialize](../../mfc/mfc-activex-controls-serializing.md)합니다.

##  <a name="dosuperclasspaint"></a>  COleControl::DoSuperclassPaint

Windows 컨트롤에서 서브클래싱된 OLE 컨트롤을 다시 그립니다.

```
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>매개 변수

*pDC*<br/>
컨트롤 컨테이너의 장치 컨텍스트에 대 한 포인터입니다.

*rcBounds*<br/>
컨트롤을 그릴 영역입니다.

### <a name="remarks"></a>설명

비활성 OLE 컨트롤의 그리기를 올바르게 처리 하려면이 함수를 호출 합니다. 이 함수는 OLE 컨트롤이 Windows 컨트롤을 서브 클래스 하 고 컨트롤의 `OnDraw` 함수에서 호출 되어야 하는 경우에만 사용 해야 합니다.

이 함수에 대 한 자세한 내용과 Windows 컨트롤 [을 서브클래싱 하는 방법에 대 한 자세한 내용은 ActiveX 컨트롤: Windows 컨트롤](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md)서브클래싱

##  <a name="drawcontent"></a>  COleControl::DrawContent

컨트롤의 모양을 업데이트 해야 할 때 프레임 워크에서 호출 됩니다.

```
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>매개 변수

*pDC*<br/>
장치 컨텍스트에 대 한 포인터입니다.

*rc*<br/>
그릴 사각형 영역입니다.

### <a name="remarks"></a>설명

이 함수는 재정의 `OnDraw` 가능한 함수를 직접 호출 합니다.

##  <a name="drawmetafile"></a>  COleControl::DrawMetafile

메타 파일 장치 컨텍스트를 사용할 때 프레임 워크에서 호출 됩니다.

```
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>매개 변수

*pDC*<br/>
메타 파일 장치 컨텍스트에 대 한 포인터입니다.

*rc*<br/>
그릴 사각형 영역입니다.

##  <a name="enablesimpleframe"></a>  COleControl::EnableSimpleFrame

OLE 컨트롤에 대 한 간단한 프레임 특징을 사용 하도록 설정 합니다.

```
void EnableSimpleFrame();
```

### <a name="remarks"></a>설명

이러한 특성을 통해 컨트롤은 다른 컨트롤의 시각적 포함을 지원할 수 있지만 진정한 OLE 포함은 지원 하지 않습니다. 예를 들어 내의 여러 컨트롤이 포함 된 그룹 상자가 있습니다. 이러한 컨트롤은 OLE가 포함 되어 있지 않지만 동일한 그룹 상자에 있습니다.

##  <a name="exchangeextent"></a>  COleControl::ExchangeExtent

컨트롤의 범위 (HIMETRIC unit의 차원) 상태를 serialize 하거나 초기화 합니다.

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>매개 변수

*pPX*<br/>
[Cpropexchange](../../mfc/reference/cpropexchange-class.md) 개체에 대 한 포인터입니다. 프레임 워크는 해당 방향을 포함 하 여 속성 교환의 컨텍스트를 설정 하기 위해이 개체를 제공 합니다.

### <a name="return-value"></a>반환 값

함수가 성공 하면 0이 아닌 값입니다. 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

이 함수는 일반적으로의 `COleControl::DoPropExchange`기본 구현에 의해 호출 됩니다.

##  <a name="exchangestockprops"></a>  COleControl::ExchangeStockProps

컨트롤의 스톡 속성 상태를 serialize 하거나 초기화 합니다.

```
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>매개 변수

*pPX*<br/>
[Cpropexchange](../../mfc/reference/cpropexchange-class.md) 개체에 대 한 포인터입니다. 프레임 워크는 해당 방향을 포함 하 여 속성 교환의 컨텍스트를 설정 하기 위해이 개체를 제공 합니다.

### <a name="remarks"></a>설명

이 함수는 일반적으로의 `COleControl::DoPropExchange`기본 구현에 의해 호출 됩니다.

##  <a name="exchangeversion"></a>  COleControl::ExchangeVersion

컨트롤 버전 정보의 상태를 serialize 하거나 초기화 합니다.

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>매개 변수

*pPX*<br/>
`CPropExchange` 개체에 대한 포인터입니다. 프레임 워크는 해당 방향을 포함 하 여 속성 교환의 컨텍스트를 설정 하기 위해이 개체를 제공 합니다.

*dwVersionDefault*<br/>
컨트롤의 현재 버전 번호입니다.

*bConvert*<br/>
영구 데이터를 저장 하거나 로드 된 것과 동일한 형식으로 유지 관리할 때 최신 형식으로 변환할지 여부를 나타냅니다.

### <a name="return-value"></a>반환 값

함수에서 0이 아닌 값을 가져왔습니다. 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

일반적으로이 함수는 컨트롤의 재정의 `COleControl::DoPropExchange`에 의해 호출 되는 첫 번째 함수입니다. 로드할 때이 함수는 영구 데이터의 버전 번호를 읽고 그에 따라 [Cpropexchange](../../mfc/reference/cpropexchange-class.md) 개체의 버전 특성을 설정 합니다. 저장 하는 경우이 함수는 영구 데이터의 버전 번호를 씁니다.

지 속성 및 버전 관리에 대 한 자세한 내용은 ActiveX [컨트롤 문서를 참조 하세요. Serialize](../../mfc/mfc-activex-controls-serializing.md)합니다.

##  <a name="fireclick"></a>  COleControl::FireClick

활성 컨트롤 위에서 마우스를 클릭할 때 프레임 워크에서 호출 됩니다.

```
void FireClick();
```

### <a name="remarks"></a>설명

이 이벤트가 사용자 지정 이벤트로 정의 된 경우 이벤트가 발생 하는 시점을 결정 합니다.

Click 이벤트가 자동으로 발생 하려면 컨트롤의 이벤트 맵에 스톡 Click 이벤트가 정의 되어 있어야 합니다.

##  <a name="firedblclick"></a>  COleControl::FireDblClick

마우스를 활성 컨트롤 위에서 두 번 클릭할 때 프레임 워크에서 호출 됩니다.

```
void FireDblClick();
```

### <a name="remarks"></a>설명

이 이벤트가 사용자 지정 이벤트로 정의 된 경우 이벤트가 발생 하는 시점을 결정 합니다.

DblClick 이벤트가 자동으로 발생 하려면 컨트롤의 이벤트 맵에 스톡 DblClick 이벤트가 정의 되어 있어야 합니다.

##  <a name="fireerror"></a>  COleControl::FireError

스톡 오류 이벤트를 발생 시킵니다.

```
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>매개 변수

*scode*<br/>
보고할 상태 코드 값입니다. 가능한 코드의 전체 목록은 ActiveX 컨트롤 문서 [를 참조 하세요. 고급 항목](../../mfc/mfc-activex-controls-advanced-topics.md)

*lpszDescription*<br/>
보고 되는 오류에 대 한 설명입니다.

*nHelpID*<br/>
보고 되는 오류에 대 한 도움말 ID입니다.

### <a name="remarks"></a>설명

이 이벤트는 컨트롤 내에서 오류가 발생 한 경우 코드의 적절 한 위치에 신호 하는 방법을 제공 합니다. 클릭 또는 MouseMove 같은 다른 스톡 이벤트와 달리 오류는 프레임 워크에서 발생 하지 않습니다.

속성 가져오기 함수, 속성 집합 함수 또는 자동화 메서드 중에 발생 하는 오류를 보고 하려면 [COleControl:: ThrowError](#throwerror)를 호출 합니다.

OLE 컨트롤의 스톡 오류 이벤트 구현은 이벤트를 발생 시 값으로 사용 합니다. 컨트롤에서이 이벤트를 사용 하 고 Visual Basic 4.0에서 사용 하려는 경우에는 Visual Basic에서이 값이 지원 되지 않기 때문에 오류를 받게 됩니다.

이 문제를 해결 하려면 컨트롤의에서 매개 변수를 수동으로 변경 합니다. ODL 파일을 **long**으로 만듭니다. 또한, 빈 매개 변수를 사용 하는 모든 사용자 지정 이벤트, 메서드 또는 속성에도 동일한 문제가 발생 합니다.

##  <a name="fireevent"></a>  COleControl::FireEvent

원하는 수의 선택적 인수를 사용 하 여 컨트롤에서 사용자 정의 이벤트를 발생 시킵니다.

```
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>매개 변수

*dispid*<br/>
발생 시킬 이벤트의 디스패치 ID입니다.

*pbParams*<br/>
이벤트의 매개 변수 형식에 대 한 설명자입니다.

### <a name="remarks"></a>설명

일반적으로이 함수는 직접 호출 하면 안 됩니다. 대신 컨트롤의 클래스 선언에 대 한 이벤트 맵 섹션에서 이벤트 발생 함수를 호출 합니다.

*Pbparams* 인수는 공백으로 구분 된 **VTS_** 목록입니다. 공백(쉼표가 아님)으로 구분된 이러한 값 중 하나 이상이 함수의 매개 변수 목록을 지정합니다. 다음과 같은 값을 사용할 수 있습니다.

|Symbol|매개 변수 유형|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE*|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
>  Variant 데이터 상수에 대 한 포인터를 제공 하는 VTS_FONT 및 VTS_PICTURE를 제외 하 고 모든 variant 형식에 대해 추가 변형 상수가 정의 되었습니다. 이러한 상수는 **VTS_P** `constantname` 규칙을 사용 하 여 명명 됩니다. 예를 들어 VTS_PCOLOR는 VTS_COLOR 상수에 대 한 포인터입니다.

##  <a name="firekeydown"></a>  COleControl::FireKeyDown

컨트롤이 UI 활성 상태에서 키를 누르면 프레임 워크에서 호출 됩니다.

```
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>매개 변수

*pnChar*<br/>
누른 키의 가상 키 코드 값에 대 한 포인터입니다. 표준 가상 키 코드의 목록은 Winuser.h를 참조 하세요.

*nShiftState*<br/>
에는 다음 플래그의 조합이 포함 되어 있습니다.

- SHIFT_MASK 동작을 수행 하는 동안 SHIFT 키를 눌렀습니다.

- CTRL_MASK 동작 중에 CTRL 키가 눌러져 있습니다.

- ALT_MASK 동작을 수행 하는 동안 ALT 키를 눌렀습니다.

### <a name="remarks"></a>설명

이 이벤트가 사용자 지정 이벤트로 정의 된 경우 이벤트가 발생 하는 시점을 결정 합니다.

KeyDown 이벤트가 자동으로 발생 하려면 컨트롤의 이벤트 맵에 스톡 KeyDown 이벤트가 정의 되어 있어야 합니다.

##  <a name="firekeypress"></a>  COleControl::FireKeyPress

사용자 지정 컨트롤이 컨테이너 내에서 UI가 활성화 되어 있는 동안 키를 눌렀다 놓았을 때 프레임 워크에서 호출 됩니다.

```
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>매개 변수

*pnChar*<br/>
누른 키의 문자 값에 대 한 포인터입니다.

### <a name="remarks"></a>설명

이 이벤트가 사용자 지정 이벤트로 정의 된 경우 이벤트가 발생 하는 시점을 결정 합니다.

이벤트의 수신자는 *Pnchar*를 수정할 수 있습니다. 예를 들어 모든 소문자를 대문자로 변환 합니다. 수정 된 문자를 검사 하려면를 재정의 `OnKeyPressEvent`합니다.

KeyPress 이벤트가 자동으로 발생 하려면 컨트롤의 이벤트 맵에 스톡 KeyPress 이벤트가 정의 되어 있어야 합니다.

##  <a name="firekeyup"></a>  COleControl::FireKeyUp

사용자 지정 컨트롤이 컨테이너 내에서 UI 활성 상태인 동안 키를 놓을 때 프레임 워크에서 호출 됩니다.

```
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>매개 변수

*pnChar*<br/>
릴리스된 키의 가상 키 코드 값에 대 한 포인터입니다. 표준 가상 키 코드의 목록은 Winuser.h를 참조 하세요.

*nShiftState*<br/>
에는 다음 플래그의 조합이 포함 되어 있습니다.

- SHIFT_MASK 동작을 수행 하는 동안 SHIFT 키를 눌렀습니다.

- CTRL_MASK 동작 중에 CTRL 키가 눌러져 있습니다.

- ALT_MASK 동작을 수행 하는 동안 ALT 키를 눌렀습니다.

### <a name="remarks"></a>설명

이 이벤트가 사용자 지정 이벤트로 정의 된 경우 이벤트가 발생 하는 시점을 결정 합니다.

KeyUp 이벤트의 자동 실행이 발생 하려면 컨트롤의 이벤트 맵에 스톡 KeyUp 이벤트가 정의 되어 있어야 합니다.

##  <a name="firemousedown"></a>  COleControl::FireMouseDown

활성 사용자 지정 컨트롤 위에서 마우스 단추를 누를 때 프레임 워크에서 호출 됩니다.

```
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>매개 변수

*nButton*<br/>
마우스 단추를 누른 숫자 값입니다. 다음 값 중 하나를 포함할 수 있습니다.

- LEFT_BUTTON 마우스 왼쪽 단추를 눌렀습니다.

- 마우스 가운데 단추를 MIDDLE_BUTTON.

- 마우스 오른쪽 단추를 RIGHT_BUTTON.

*nShiftState*<br/>
에는 다음 플래그의 조합이 포함 되어 있습니다.

- SHIFT_MASK 동작을 수행 하는 동안 SHIFT 키를 눌렀습니다.

- CTRL_MASK 동작 중에 CTRL 키가 눌러져 있습니다.

- ALT_MASK 동작을 수행 하는 동안 ALT 키를 눌렀습니다.

*x*<br/>
마우스 단추를 누른 경우 커서의 x 좌표입니다. 좌표는 컨트롤 창의 왼쪽 위 모퉁이를 기준으로 합니다.

*y*<br/>
마우스 단추를 누른 경우 커서의 y 좌표입니다. 좌표는 컨트롤 창의 왼쪽 위 모퉁이를 기준으로 합니다.

### <a name="remarks"></a>설명

이 이벤트가 사용자 지정 이벤트로 정의 된 경우 이벤트가 발생 하는 시점을 결정 합니다.

MouseDown 이벤트의 자동 실행이 발생 하려면 컨트롤의 이벤트 맵에 스톡 MouseDown 이벤트가 정의 되어 있어야 합니다.

##  <a name="firemousemove"></a>  COleControl::FireMouseMove

커서가 활성 사용자 지정 컨트롤 위로 이동할 때 프레임 워크에서 호출 됩니다.

```
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>매개 변수

*nButton*<br/>
마우스 단추를 누른 숫자 값입니다. 에는 다음 값의 조합이 포함 되어 있습니다.

- LEFT_BUTTON 작업 중에 마우스 왼쪽 단추를 눌렀습니다.

- 작업 하는 동안 마우스 가운데 단추를 MIDDLE_BUTTON.

- RIGHT_BUTTON 작업을 수행 하는 동안 마우스 오른쪽 단추를 눌렀습니다.

*nShiftState*<br/>
에는 다음 플래그의 조합이 포함 되어 있습니다.

- SHIFT_MASK 동작을 수행 하는 동안 SHIFT 키를 눌렀습니다.

- CTRL_MASK 동작 중에 CTRL 키가 눌러져 있습니다.

- ALT_MASK 동작을 수행 하는 동안 ALT 키를 눌렀습니다.

*x*<br/>
커서의 x 좌표입니다. 좌표는 컨트롤 창의 왼쪽 위 모퉁이를 기준으로 합니다.

*y*<br/>
커서의 y 좌표입니다. 좌표는 컨트롤 창의 왼쪽 위 모퉁이를 기준으로 합니다.

### <a name="remarks"></a>설명

이 이벤트가 사용자 지정 이벤트로 정의 된 경우 이벤트가 발생 하는 시점을 결정 합니다.

MouseMove 이벤트가 자동으로 발생 하려면 컨트롤의 이벤트 맵에 스톡 MouseMove 이벤트가 정의 되어 있어야 합니다.

##  <a name="firemouseup"></a>  COleControl::FireMouseUp

활성 사용자 지정 컨트롤 위에서 마우스 단추를 놓을 때 프레임 워크에서 호출 됩니다.

```
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>매개 변수

*nButton*<br/>
마우스 단추를 놓은 숫자 값입니다. 다음 값 중 하나를 사용할 수 있습니다.

- 왼쪽 마우스 단추를 LEFT_BUTTON.

- 마우스 가운데 단추를 놓았음을 MIDDLE_BUTTON.

- 마우스 오른쪽 단추를 RIGHT_BUTTON.

*nShiftState*<br/>
에는 다음 플래그의 조합이 포함 되어 있습니다.

- SHIFT_MASK 동작을 수행 하는 동안 SHIFT 키를 눌렀습니다.

- CTRL_MASK 동작 중에 CTRL 키가 눌러져 있습니다.

- ALT_MASK 동작을 수행 하는 동안 ALT 키를 눌렀습니다.

*x*<br/>
마우스 단추를 놓을 때 커서의 x 좌표입니다. 좌표는 컨트롤 창의 왼쪽 위 모퉁이를 기준으로 합니다.

*y*<br/>
마우스 단추를 놓을 때 커서의 y 좌표입니다. 좌표는 컨트롤 창의 왼쪽 위 모퉁이를 기준으로 합니다.

### <a name="remarks"></a>설명

이 이벤트가 사용자 지정 이벤트로 정의 된 경우 이벤트가 발생 하는 시점을 결정 합니다.

MouseUp 이벤트가 자동으로 발생 하려면 컨트롤의 이벤트 맵에 스톡 MouseUp 이벤트가 정의 되어 있어야 합니다.

##  <a name="firereadystatechange"></a>  COleControl::FireReadyStateChange

준비 상태 컨트롤의 현재 값을 사용 하 여 이벤트를 발생 시킵니다.

```
void FireReadyStateChange();
```

### <a name="remarks"></a>설명

준비 상태는 다음 값 중 하나일 수 있습니다.

|||
|-|-|
|READYSTATE_UNINITIALIZED|기본 초기화 상태|
|READYSTATE_LOADING|컨트롤이 현재 속성을 로드 하 고 있습니다.|
|READYSTATE_LOADED|컨트롤이 초기화 되었습니다.|
|READYSTATE_INTERACTIVE|컨트롤에 대화형으로 사용할 수 있는 데이터가 충분 하지만 일부 비동기 데이터는 아직 로드 되지 않았습니다.|
|READYSTATE_COMPLETE|컨트롤에 모든 데이터 포함|

[Getreadystate](#getreadystate) 를 사용 하 여 컨트롤의 현재 준비 상태를 확인 합니다.

[Internalsetreadystate](#internalsetreadystate) 는 준비 상태를 제공 된 값으로 변경 하 고 `FireReadyStateChange`를 호출 합니다.

##  <a name="getactivationpolicy"></a>  COleControl::GetActivationPolicy

인터페이스를 `IPointerInactive` 지 원하는 컨트롤의 기본 활성화 동작을 변경 합니다.

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>반환 값

POINTERINACTIVE 열거의 플래그 조합입니다. 가능한 플래그는 다음과 같습니다.

|||
|-|-|
|POINTERINACTIVE_ACTIVATEONENTRY|마우스 이동 작업 중에 마우스를 가져가면 개체가 활성화 된 상태로 활성화 됩니다.|
|POINTERINACTIVE_DEACTIVATEONLEAVE|마우스가 마우스 이동 작업을 수행 하는 동안 개체를 벗어나면 비활성화 되어야 합니다.|
|POINTERINACTIVE_ACTIVATEONDRAG|끌어서 놓기 작업을 수행 하는 동안 마우스를 위로 이동 하면 개체가 내부 활성화 되어 있어야 합니다.|

### <a name="remarks"></a>설명

`IPointerInactive` 인터페이스를 사용 하도록 설정 하면 컨테이너에서 WM_SETCURSOR 및 WM_MOUSEMOVE 메시지를 위임 합니다. `COleControl`이 인터페이스를 구현 하면 마우스 좌표를 적절 하 게 조정한 후 컨트롤의 메시지 맵을 통해 이러한 메시지를 디스패치합니다.

컨테이너는를 지 원하는 `IPointerInactive`비활성 개체 위에 마우스 포인터를 놓고 WM_SETCURSOR 또는 WM_MOUSEMOVE 메시지를 받을 때마다 인터페이스에서를 호출 `GetActivationPolicy` 하 고 pointerinactive 열거에서 플래그를 반환 해야 합니다.

메시지 맵에 해당 항목을 추가 하 여 일반 창 메시지와 마찬가지로 이러한 메시지를 처리할 수 있습니다. 처리기에서 먼저 해당 값이 NULL `m_hWnd` 이 아닌지 확인 하지 않고 멤버 변수 (또는이를 사용 하는 멤버 함수)를 사용 하지 않습니다.

마우스 커서를 설정 하거나 마우스 이동 이벤트를 실행 하는 것 보다 많은 개체는 특별 한 시각적 피드백을 제공 하는 것과 같이 POINTERINACTIVE_ACTIVATEONENTRY 플래그를 반환 하 고 활성 상태인 경우에만 피드백을 그려야 합니다. 개체가이 플래그를 반환 하는 경우 컨테이너는 즉시이 플래그를 활성화 한 다음 호출 `GetActivationPolicy`을 트리거한 동일한 메시지로 전달 해야 합니다.

POINTERINACTIVE_ACTIVATEONENTRY 및 POINTERINACTIVE_DEACTIVATEONLEAVE 플래그를 모두 반환 하는 경우 개체를 마우스로 가리킬 때만 개체가 활성화 됩니다. POINTERINACTIVE_ACTIVATEONENTRY 플래그만 반환 되는 경우에는 마우스가 처음 개체에 들어가면 개체가 한 번만 활성화 됩니다.

비활성 컨트롤을 OLE 끌어서 놓기 작업의 대상으로 지정할 수도 있습니다. 이렇게 하려면 컨트롤의 창을 놓기 대상으로 등록할 수 있도록 사용자가 개체를 끌 때 컨트롤을 활성화 해야 합니다. 끌기 중에 활성화를 발생 시키려면 POINTERINACTIVE_ACTIVATEONDRAG 플래그를 반환 합니다.

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

에서 통신 하 `GetActivationPolicy` 는 정보는 컨테이너에 의해 캐시 되지 않아야 합니다. 대신, 마우스가 비활성 개체에 들어갈 때마다이 메서드를 호출 해야 합니다.

비활성 개체가 마우스를 가져갈 때 내부 활성화 되도록 요청 하지 않는 경우 해당 컨테이너는 마우스 포인터가 개체 위에 있는 동안 [Oninactivesetcursor](#oninactivesetcursor) 를 호출 하 여이 개체에 대 한 후속 WM_SETCURSOR 메시지를 디스패치합니다.

일반적으로 `IPointerInactive` 인터페이스를 사용 하도록 설정 하면 컨트롤에서 마우스 메시지를 항상 처리할 수 있습니다. `IPointerInactive` 인터페이스를 지원 하지 않는 컨테이너에서이 동작을 가져오려면 컨트롤이 표시 될 때 항상 활성화 되어 있어야 합니다. 즉, 컨트롤의 기타 플래그 사이에 OLEMISC_ACTIVATEWHENVISIBLE 플래그가 있어야 합니다. 그러나이 플래그를 지 원하는 `IPointerInactive`컨테이너에서이 플래그를 적용 하지 않으려면 OLEMISC_IGNOREACTIVATEWHENVISIBLE 플래그를 지정 하면 됩니다.

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

##  <a name="getambientproperty"></a>  COleControl::GetAmbientProperty

컨테이너의 앰비언트 속성 값을 가져옵니다.

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>매개 변수

*dwDispid*<br/>
원하는 앰비언트 속성의 디스패치 ID입니다.

*vtProp*<br/>
*PvProp*에서 반환 될 값의 형식을 지정 하는 variant 형식 태그입니다.

*pvProp*<br/>
속성 값 이나 반환 값을 받을 변수의 주소에 대 한 포인터입니다. 이 포인터의 실제 형식은 *vtProp*에 지정 된 형식과 일치 해야 합니다.

|vtProp|PvProp의 형식|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>반환 값

앰비언트 속성이 지원 되는 경우 0이 아닙니다. 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

를 사용 `GetAmbientProperty` 하 여 앰비언트 DisplayName 및 ScaleUnits 속성을 검색 하는 경우 *vtProp* 를 VT_BSTR로 설정 하 고 *pvProp* 를로 `CString*`설정 합니다. 앰비언트 글꼴 속성을 검색 하는 경우 *vtProp* 을 VT_FONT로 설정 하 고 *PVPROP* 을 lpdisp disp *로 설정 합니다.

[AmbientBackColor](#ambientbackcolor) 및 [AmbientFont](#ambientfont)와 같은 일반적인 앰비언트 속성에는 함수가 이미 제공 되어 있습니다.

##  <a name="getappearance"></a>  COleControl::GetAppearance

컨트롤의 스톡 모양 속성의 Get 함수를 구현 합니다.

```
short GetAppearance ();
```

### <a name="return-value"></a>반환 값

성공 하는 경우 반환 값은 현재 모양 설정을 **short** (VT_I2) 값으로 지정 합니다. 컨트롤의 모양이 flat 이면이 값은 0이 고, 컨트롤의 모양이 3D 이면 1입니다.

##  <a name="getbackcolor"></a>  COleControl::GetBackColor

컨트롤의 스톡 BackColor 속성의 Get 함수를 구현 합니다.

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>반환 값

성공 하면 반환 값은 현재 배경색을 OLE_COLOR 값으로 지정 합니다. 이 값은를 `TranslateColor`호출 하 여 colorref 값으로 변환할 수 있습니다.

##  <a name="getborderstyle"></a>  COleControl::GetBorderStyle

컨트롤의 스톡 BorderStyle 속성의 Get 함수를 구현 합니다.

```
short GetBorderStyle();
```

### <a name="return-value"></a>반환 값

컨트롤에 표준 테두리가 있으면 1이 고, 그렇지 않으면입니다. 컨트롤에 테두리가 없으면 0입니다.

##  <a name="getcapture"></a>  COleControl::GetCapture

개체에 `COleControl` 마우스 캡처가 있는지 여부를 확인 합니다.

```
CWnd* GetCapture();
```

### <a name="return-value"></a>반환 값

컨트롤이 활성화 되 고 창이 없는 경우 컨트롤에 현재 마우스 캡처가 있으면 (컨트롤의 컨테이너에 의해 결정 됨) **이** 값을 반환 하 고, 캡처가 없으면 NULL을 반환 합니다.

그렇지 않으면와 `CWnd::GetCapture`동일한 `CWnd` 마우스 캡처가 있는 개체를 반환 합니다.

### <a name="remarks"></a>설명

활성화 된 창 없는 컨트롤은 [Setcapture](#setcapture) 가 호출 될 때 마우스 캡처를 수신 합니다.

##  <a name="getclassid"></a>  COleControl::GetClassID

컨트롤의 OLE 클래스 ID를 검색 하기 위해 프레임 워크에서 호출 됩니다.

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>매개 변수

*pclsid*<br/>
클래스 ID의 위치에 대 한 포인터입니다.

### <a name="return-value"></a>반환 값

호출이 실패 한 경우 0이 아닌 값입니다. 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

일반적으로 [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex)에 의해 구현 됩니다.

##  <a name="getclientoffset"></a>  COleControl::GetClientOffset

컨트롤의 사각형 영역 왼쪽 위 모퉁이와 해당 클라이언트 영역의 왼쪽 위 모퉁이 간 차이를 검색 합니다.

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>매개 변수

*pdxOffset*<br/>
OLE 컨트롤 클라이언트 영역의 가로 오프셋에 대 한 포인터입니다.

*pdyOffset*<br/>
OLE 컨트롤의 클라이언트 영역에 대 한 세로 오프셋에 대 한 포인터입니다.

### <a name="remarks"></a>설명

OLE 컨트롤의 컨테이너 안에는 사각형 영역이 있습니다. 컨트롤의 클라이언트 영역은 테두리 및 스크롤 막대를 제외한 컨트롤 영역입니다. 로 `GetClientOffset` 검색 된 오프셋은 컨트롤의 사각형 영역 왼쪽 위 모퉁이와 해당 클라이언트 영역의 왼쪽 위 모퉁이 간 차이입니다. 컨트롤에 표준 테두리 및 스크롤 막대가 아닌 비클라이언트 요소가 있으면이 멤버 함수를 재정의 하 여 오프셋을 지정 합니다.

##  <a name="getclientrect"></a>  COleControl::GetClientRect

컨트롤 클라이언트 영역의 크기를 검색 합니다.

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>매개 변수

*lpRect*<br/>
창 없는 컨트롤 `RECT` 의 클라이언트 영역 차원이 포함 된 구조체에 대 한 포인터입니다. 즉, 컨트롤의 크기가 창 테두리, 프레임, 스크롤 막대 등을 뺀 값입니다. *LpRect* 매개 변수는 컨트롤이 위치가 아닌 클라이언트 사각형의 크기를 나타냅니다.

##  <a name="getclientsite"></a>  COleControl::GetClientSite

해당 컨테이너 내의 현재 클라이언트 사이트에 대 한 포인터 개체를 쿼리 합니다.

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>반환 값

컨테이너에 있는 컨트롤의 현재 클라이언트 사이트에 대 한 포인터입니다.

### <a name="remarks"></a>설명

반환 된 포인터는의 `IOleClientSite`인스턴스를 가리킵니다. 컨테이너에 의해 구현 되는 인터페이스는해당컨텍스트의개체뷰입니다.문서에고정되어있습니다.여기에서저장소,사용자인터페이스및기타리소스를가져옵니다.`IOleClientSite`

##  <a name="getcontrolflags"></a>  COleControl::GetControlFlags

컨트롤 플래그 설정을 검색 합니다.

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>반환 값

ControlFlags 열거에서 플래그의 ORed 조합입니다.

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>설명

기본적으로 `GetControlFlags` 반환 `fastBeginPaint | clipPaintDC`합니다.

|||
|-|-|
|`fastBeginPaint`|설정 하는 경우 [beginpaint](/windows/win32/api/winuser/nf-winuser-beginpaint) API (기본적으로 설정) 대신 OLE 컨트롤에 맞게 조정 된 시작-그리기 함수를 사용 합니다.|
|`clipPaintDC`|설정 하지 않으면에서 `IntersectClipRect` `COleControl` 에 대 한 호출을 사용 하지 않도록 설정 하 고 속도가 약간 향상 됩니다. 창 없는 활성화를 사용 하는 경우 플래그는 영향을 주지 않습니다.|
|`pointerInactive`|설정 하는 경우 기본적으로 사용 하지 않도록 설정 된 `COleControl` `IPointerInactive` 인터페이스의 구현을 사용 하 여 컨트롤이 비활성화 된 상태에서 마우스 상호 작용을 제공 합니다.|
|`noFlickerActivate`|설정 하는 경우 추가 그리기 작업 및 함께 제공 되는 시각적 깜박임을 제거 합니다. 컨트롤이 비활성 및 활성 상태에서 동일 하 게 그려지는 경우를 사용 합니다. 창 없는 활성화를 사용 하는 경우 플래그는 영향을 주지 않습니다.|
|`windowlessActivate`|설정 하는 경우 컨트롤에서 창 없는 활성화를 사용 함을 나타냅니다.|
|`canOptimizeDraw`|설정 하는 경우 컨테이너에서 지원 되는 경우 컨트롤이 최적화 된 그리기를 수행 함을 나타냅니다.|

및 OLE 컨트롤의 `GetControlFlags` 기타 최적화에 대 한 자세한 내용은 ActiveX [컨트롤을 참조 하세요. 최적화](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="getcontrolsize"></a>  COleControl::GetControlSize

OLE 컨트롤 창의 크기를 검색 합니다.

```
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>매개 변수

*pcx*<br/>
컨트롤의 너비 (픽셀)를 지정 합니다.

*pcy*<br/>
컨트롤의 높이 (픽셀)를 지정 합니다.

### <a name="remarks"></a>설명

컨트롤 창의 모든 좌표는 컨트롤의 왼쪽 위 모퉁이를 기준으로 합니다.

##  <a name="getdc"></a>  COleControl::GetDC

창 없는 개체를 제공 하 여 해당 컨테이너에서 화면 또는 호환 되는 장치 컨텍스트를 가져옵니다.

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>매개 변수

*lprcRect*<br/>
창 없는 컨트롤에서 다시 그릴 컨트롤의 클라이언트 좌표에 있는 사각형에 대 한 포인터입니다. NULL은 전체 개체의 익스텐트를 의미 합니다.

*dwFlags*<br/>
장치 컨텍스트의 그리기 특성입니다. 선택 항목은 다음과 같습니다.

- OLEDC_NODRAW은 개체가 장치 컨텍스트를 사용 하 여 그리기를 수행 하는 것이 아니라 단순히 디스플레이 장치에 대 한 정보를 가져오는 것을 나타냅니다. 컨테이너는 추가 처리 없이 창의 DC를 전달 하기만 하면 됩니다.

- OLEDC_PAINTBKGND는 DC를 반환 하기 전에 컨테이너가 배경을 칠하도록 요청 합니다. 개체는 투명 한 배경으로 영역을 다시 그리기 위해 DC를 요청 하는 경우이 플래그를 사용 해야 합니다.

- OLEDC_OFFSCREEN는 개체가 화면에 복사 되어야 하는 화면 밖 비트맵으로 렌더링 하려는 컨테이너를 알립니다. 개체는 수행 하려는 그리기 작업이 많은 깜박임을 생성 하는 경우이 플래그를 사용 해야 합니다. 컨테이너는이 요청을 그대로 사용할 수 있습니다. 그러나이 플래그를 설정 하지 않으면 컨테이너에서 화면 DC를 다시 만들어야 합니다. 이렇게 하면 개체에서 **XOR** 작업을 통해 선택 항목을 표시 하는 등의 직접 화면 작업을 수행할 수 있습니다.

### <a name="return-value"></a>반환 값

성공 하면 컨테이너 `CWnd` 클라이언트 영역에 대 한 디스플레이 장치 컨텍스트에 대 한 포인터이 고, 그렇지 않으면 반환 값이 NULL입니다. 표시 장치 컨텍스트는 컨테이너 창의 클라이언트 영역에서 그리는 다음 GDI 함수에서 사용할 수 있습니다.

### <a name="remarks"></a>설명

그리기 후에 컨텍스트를 해제 하려면 [Releasedc](#releasedc) 구성원 함수를 호출 해야 합니다. 를 호출 `GetDC`하는 경우 개체는 그리려는 사각형을 자체 클라이언트 좌표로 전달 합니다. `GetDC`이러한를 컨테이너 클라이언트 영역의 좌표로 변환 합니다. 개체는 자체 클라이언트 영역 사각형 보다 큰 원하는 그리기 사각형을 요청 하지 않아야 합니다 .이 크기는 [Getclientrect](#getclientrect)를 사용 하 여 검색할 수 있습니다. 이렇게 하면 개체가 의도 하지 않은 위치에서 실수로 그려지지 않습니다.

##  <a name="getenabled"></a>  COleControl::GetEnabled

컨트롤의 스톡 사용 속성에 대 한 Get 함수를 구현 합니다.

```
BOOL GetEnabled();
```

### <a name="return-value"></a>반환 값

컨트롤을 사용할 수 있는 경우 0이 아닌 값입니다. 그렇지 않으면 0입니다.

##  <a name="getextendedcontrol"></a>  COleControl::GetExtendedControl

확장 속성 집합을 사용 하 여 컨트롤을 나타내는 컨테이너에서 유지 관리 되는 개체에 대 한 포인터를 가져옵니다.

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>반환 값

컨테이너의 확장 컨트롤 개체에 대 한 포인터입니다. 사용할 수 있는 개체가 없으면이 값은 NULL입니다.

이 개체는 `IDispatch` 인터페이스를 통해 조작할 수 있습니다. 를 사용 `QueryInterface` 하 여 개체에서 제공 하는 다른 사용 가능한 인터페이스를 가져올 수도 있습니다. 그러나 개체는 특정 인터페이스 집합을 지 원하는 데 필요 하지 않습니다. 컨테이너의 확장 컨트롤 개체의 특정 기능에 의존 하 여 컨트롤의 이식성은 다른 임의의 컨테이너로 제한 됩니다.

### <a name="remarks"></a>설명

이 함수를 호출 하는 함수는 개체를 마칠 때 포인터를 해제 해야 합니다. 컨테이너는이 개체를 지 원하는 데 필요 하지 않습니다.

##  <a name="getfocus"></a>  COleControl::GetFocus

`COleControl` 개체에 포커스가 있는지 여부를 확인 합니다.

```
CWnd* GetFocus();
```

### <a name="return-value"></a>반환 값

컨트롤이 활성화 되 고 창이 없는 경우 컨트롤에 현재 키보드 포커스 (컨트롤의 컨테이너에 의해 결정 됨)가 있는 경우 **이** 를 반환 하 고, 포커스가 없으면 NULL을 반환 합니다.

그렇지 않으면 포커스가 있는 `CWnd` 개체를 반환 합니다 (와 `CWnd::GetFocus`같음).

### <a name="remarks"></a>설명

[SetFocus](#setfocus) 를 호출할 때 활성화 된 창 없는 컨트롤은 포커스를 받습니다.

##  <a name="getfont"></a>  COleControl::GetFont

스톡 글꼴 속성의 Get 함수를 구현 합니다.

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>반환 값

컨트롤의 스톡 글꼴 속성의 글꼴 디스패치 인터페이스에 대 한 포인터입니다.

### <a name="remarks"></a>설명

완료 되 면 호출자가 개체를 해제 해야 합니다. 컨트롤의 구현 내에서를 사용 `InternalGetFont` 하 여 컨트롤의 스톡 글꼴 개체에 액세스 합니다. 컨트롤에서 글꼴을 사용 하는 방법에 대 한 자세한 내용은 [ActiveX 컨트롤 문서를 참조 하세요. ActiveX 컨트롤](../../mfc/mfc-activex-controls-using-fonts.md)에서 글꼴 사용

##  <a name="getfonttextmetrics"></a>  COleControl::GetFontTextMetrics

컨트롤에서 소유 하는 모든 `CFontHolder` 개체에 대 한 텍스트 메트릭을 측정 합니다.

```
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>매개 변수

*lptm*<br/>
[Textmetric](/windows/win32/api/wingdi/ns-wingdi-textmetricw) 구조체에 대 한 포인터입니다.

*fontHolder*<br/>
[Cfontholder](../../mfc/reference/cfontholder-class.md) 된 개체에 대 한 참조입니다.

### <a name="remarks"></a>설명

이러한 글꼴은 [COleControl:: select글꼴](#selectfontobject) 함수를 사용 하 여 선택할 수 있습니다. `GetFontTextMetrics`성공 하는 `TEXTMETRIC` 경우의 글꼴에 대 한 `fontHolder`유효한 메트릭 정보를 사용 하 여 *lptm* 가 가리키는 구조체를 초기화 하거나, 성공 하지 않으면 0으로 구조체를 채웁니다. 포함 된 OLE 개체와 마찬가지로 컨트롤을 메타 파일로 렌더링 해야 할 수 있으므로 컨트롤을 [그릴 때이](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) 함수를 사용 해야 합니다.

[Select 개체](#selectfontobject) 함수를 호출 하면 기본 글꼴의 구조가새로고쳐집니다.`TEXTMETRIC` 스톡 글꼴 속성 `GetFontTextMetrics` 을 선택한 후에만를 호출 하 여 제공 된 정보가 유효한 지를 보장 해야 합니다.

##  <a name="getforecolor"></a>  COleControl::GetForeColor

스톡 ForeColor 속성의 Get 함수를 구현 합니다.

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>반환 값

성공 하면 반환 값은 현재 전경색을 OLE_COLOR 값으로 지정 합니다. 이 값은를 `TranslateColor`호출 하 여 [colorref](/windows/win32/gdi/colorref) 값으로 변환할 수 있습니다.

##  <a name="gethwnd"></a>  COleControl::GetHwnd

스톡 hWnd 속성의 Get 함수를 구현 합니다.

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>반환 값

OLE 컨트롤의 창 핸들입니다 (있는 경우). 그렇지 않으면 NULL입니다.

##  <a name="getmessagestring"></a>  COleControl::GetMessageString

*NID*로 식별 되는 메뉴 항목의 용도를 설명 하는 간단한 문자열을 가져오기 위해 프레임 워크에서 호출 됩니다.

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>매개 변수

*nID*<br/>
메뉴 항목 ID입니다.

*rMessage*<br/>
문자열이 반환 되는 [CString](../../atl-mfc-shared/reference/cstringt-class.md) 개체에 대 한 참조입니다.

### <a name="remarks"></a>설명

메뉴 항목을 강조 표시 하는 동안 상태 표시줄에 표시할 메시지를 가져오는 데 사용할 수 있습니다. 기본 구현에서는 *nID*로 식별 된 문자열 리소스를 로드 하려고 합니다.

##  <a name="getnotsupported"></a>  COleControl::GetNotSupported

사용자가 컨트롤의 속성 값에 액세스할 수 없도록 합니다.

```
void GetNotSupported();
```

### <a name="remarks"></a>설명

컨트롤의 사용자가 속성을 검색 하는 것이 지원 되지 않는 모든 속성의 Get 함수 대신이 함수를 호출 합니다. 한 가지 예는 쓰기 전용 속성입니다.

##  <a name="getreadystate"></a>  COleControl::GetReadyState

컨트롤의 준비 상태를 반환 합니다.

```
long GetReadyState();
```

### <a name="return-value"></a>반환 값

컨트롤의 준비 상태 이며 다음 값 중 하나입니다.

|||
|-|-|
|READYSTATE_UNINITIALIZED|기본 초기화 상태|
|READYSTATE_LOADING|컨트롤이 현재 속성을 로드 하 고 있습니다.|
|READYSTATE_LOADED|컨트롤이 초기화 되었습니다.|
|READYSTATE_INTERACTIVE|컨트롤에 대화형으로 사용할 수 있는 데이터가 충분 하지만 일부 비동기 데이터는 아직 로드 되지 않았습니다.|
|READYSTATE_COMPLETE|컨트롤에 모든 데이터 포함|

### <a name="remarks"></a>설명

가장 간단한 컨트롤은 로드 된 대화형을 구분할 필요가 없습니다. 그러나 데이터 경로 속성을 지 원하는 컨트롤은 적어도 일부 데이터가 비동기적으로 수신 될 때까지 interactive로 준비 되지 않을 수 있습니다. 컨트롤은 가능한 한 빨리 대화형으로 전환 하려고 합니다.

##  <a name="getrectincontainer"></a>  COleControl::GetRectInContainer

장치 단위로 표현 된 컨테이너를 기준으로 하는 컨트롤 사각형의 좌표를 가져옵니다.

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>매개 변수

*lpRect*<br/>
컨트롤의 좌표가 복사 될 사각형 구조에 대 한 포인터입니다.

### <a name="return-value"></a>반환 값

컨트롤이 내부 활성 상태 이면 0이 아닌 값입니다. 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

사각형은 컨트롤이 내부 활성 상태인 경우에만 유효 합니다.

##  <a name="getstocktextmetrics"></a>  COleControl::GetStockTextMetrics

[SelectStockFont](#selectstockfont) 함수를 사용 하 여 선택할 수 있는 컨트롤의 스톡 글꼴 속성에 대 한 텍스트 메트릭을 측정 합니다.

```
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>매개 변수

*lptm*<br/>
[Textmetric](/windows/win32/api/wingdi/ns-wingdi-textmetricw) 구조체에 대 한 포인터입니다.

### <a name="remarks"></a>설명

이 `GetStockTextMetrics` 함수는 성공 하 `TEXTMETRIC` 는 경우 유효한 메트릭 정보를 사용 하 여 *lptm* 에서 가리키는 구조체를 초기화 하거나, 성공 하지 않은 경우 0으로 구조체를 채웁니다. 포함 된 OLE 개체와 같은 컨트롤이 메타 파일로 렌더링 되어야 하는 경우 컨트롤을 그릴 때 [Gettextmetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) 대신이 함수를 사용 합니다.

함수가 호출 될 때 기본 글꼴의 구조가새로고쳐집니다.`TEXTMETRIC` `SelectStockFont` 제공 된 정보가 유효한 지 확인할 수 있도록 스톡 글꼴을 선택한 후에만이 함수를 호출 해야 합니다.

##  <a name="gettext"></a>  COleControl::GetText

스톡 Text 또는 Caption 속성의 Get 함수를 구현 합니다.

```
BSTR GetText();
```

### <a name="return-value"></a>반환 값

컨트롤 텍스트 문자열의 현재 값 또는 문자열이 없는 경우 길이가 0 인 문자열입니다.

> [!NOTE]
>  BSTR 데이터 형식에 대 한 자세한 내용은 매크로 및 전역 섹션에서 [데이터 형식](../../mfc/reference/data-types-mfc.md) 을 참조 하세요.

### <a name="remarks"></a>설명

이 함수의 호출자는 리소스를 해제 하기 위해 `SysFreeString` 반환 된 문자열에서를 호출 해야 합니다. 컨트롤의 구현 내에서를 사용 `InternalGetText` 하 여 컨트롤의 스톡 텍스트 또는 캡션 속성에 액세스 합니다.

##  <a name="getwindowlessdroptarget"></a>  COleControl::GetWindowlessDropTarget

창 `GetWindowlessDropTarget` 없는 컨트롤을 OLE 끌어서 놓기 작업의 대상으로 사용할 때 재정의 합니다.

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>반환 값

개체의 `IDropTarget` 인터페이스에 대 한 포인터입니다. 창에는 창이 없으므로 창 없는 개체는 `IDropTarget` 인터페이스를 등록할 수 없습니다. 그러나 끌어서 놓기를 참여 하기 위해 창 없는 개체는 여전히 인터페이스를 구현 하 고에서 `GetWindowlessDropTarget`반환할 수 있습니다.

### <a name="remarks"></a>설명

일반적으로 이를 위해서는 컨트롤의 창이 놓기 대상으로 등록되어야 합니다. 그러나 컨트롤에 자체 창이 없기 때문에 컨테이너는 자체 창을 놓기 대상으로 사용 합니다. 컨트롤은 컨테이너가 적절 한 시간에 호출을 위임할 `IDropTarget` 수 있는 인터페이스의 구현을 제공 하기만 하면 됩니다. 예를 들어:

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

##  <a name="initializeiids"></a>  COleControl::InitializeIIDs

컨트롤에서 사용 하는 Iid의 기본 클래스에 알립니다.

```
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>매개 변수

*piidPrimary*<br/>
컨트롤의 기본 디스패치 인터페이스의 인터페이스 ID에 대 한 포인터입니다.

*piidEvents*<br/>
컨트롤의 이벤트 인터페이스에 대 한 인터페이스 ID에 대 한 포인터입니다.

### <a name="remarks"></a>설명

컨트롤의 생성자에서이 함수를 호출 하 여 컨트롤에서 사용 하는 인터페이스 Id의 기본 클래스에 알립니다.

##  <a name="internalgetfont"></a>  COleControl::InternalGetFont

컨트롤의 스톡 글꼴 속성에 액세스 합니다.

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>반환 값

스톡 글꼴 개체를 포함 하는 [Cfontholder](../../mfc/reference/cfontholder-class.md) 개체에 대 한 참조입니다.

##  <a name="internalgettext"></a>  COleControl::InternalGetText

컨트롤의 스톡 텍스트 또는 Caption 속성에 액세스 합니다.

```
const CString& InternalGetText();
```

### <a name="return-value"></a>반환 값

컨트롤 텍스트 문자열에 대 한 참조입니다.

##  <a name="internalsetreadystate"></a>  COleControl::InternalSetReadyState

컨트롤의 준비 상태를 설정 합니다.

```
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>매개 변수

*lNewReadyState*<br/>
컨트롤에 대해 설정할 준비 상태 이며 다음 값 중 하나입니다.

|||
|-|-|
|READYSTATE_UNINITIALIZED|기본 초기화 상태|
|READYSTATE_LOADING|컨트롤이 현재 속성을 로드 하 고 있습니다.|
|READYSTATE_LOADED|컨트롤이 초기화 되었습니다.|
|READYSTATE_INTERACTIVE|컨트롤에 대화형으로 사용할 수 있는 데이터가 충분 하지만 일부 비동기 데이터는 아직 로드 되지 않았습니다.|
|READYSTATE_COMPLETE|컨트롤에 모든 데이터 포함|

### <a name="remarks"></a>설명

가장 간단한 컨트롤은 로드 된 대화형을 구분할 필요가 없습니다. 그러나 데이터 경로 속성을 지 원하는 컨트롤은 적어도 일부 데이터가 비동기적으로 수신 될 때까지 interactive로 준비 되지 않을 수 있습니다. 컨트롤은 가능한 한 빨리 대화형으로 전환 하려고 합니다.

##  <a name="invalidatecontrol"></a>  COleControl::InvalidateControl

컨트롤을 강제로 다시 그리도록 합니다.

```
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>매개 변수

*lpRect*<br/>
무효화할 컨트롤 영역에 대 한 포인터입니다.

*bErase*<br/>
업데이트 영역을 처리할 때 업데이트 영역 내의 배경을 지우도록 할지 여부를 지정 합니다.

### <a name="remarks"></a>설명

*LpRect* 의 값이 NULL 이면 전체 컨트롤이 다시 그려집니다. *LpRect* 가 NULL이 아닌 경우 무효화 될 컨트롤의 사각형 부분을 나타냅니다. 컨트롤에 창이 없거나 현재 활성화 되어 있지 않은 경우에는 사각형이 무시 되 고 클라이언트 사이트의 [IAdviseSink:: OnViewChange](/windows/win32/api/objidl/nf-objidl-iadvisesink-onviewchange) 멤버 함수에 대 한 호출이 수행 됩니다. `CWnd::InvalidateRect` 또는`InvalidateRect`대신이 함수를 사용 합니다.

##  <a name="invalidatergn"></a>  COleControl::InvalidateRgn

지정 된 영역 내에서 컨테이너 창의 클라이언트 영역을 무효화 합니다.

```
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>매개 변수

*pRgn*<br/>
포함 하는 창의 클라이언트 좌표에서 무효화할 OLE 개체의 표시 영역을 식별 하는 [CRgn](../../mfc/reference/crgn-class.md) 개체에 대 한 포인터입니다. 이 매개 변수가 NULL 인 경우 익스텐트는 전체 개체입니다.

*bErase*<br/>
무효화 된 영역 내의 배경을 지울 것인지 여부를 지정 합니다. TRUE 이면 배경이 지워집니다. FALSE 이면 배경이 변경 되지 않은 상태로 유지 됩니다.

### <a name="remarks"></a>설명

이를 사용 하 여 컨테이너 내에서 창 없는 컨트롤을 다시 그릴 수 있습니다. 업데이트 영역의 다른 모든 영역과 함께 무효화 된 영역은 다음 [WM_PAINT](/windows/win32/gdi/wm-paint) 메시지를 보낼 때 그리기 위해 표시 됩니다.

업데이트 영역의 임의 부분에 대 한 전체 지역에 *대해이를 TRUE로 설정* 하면 지정 된 파트 뿐만 아니라 전체 지역에서 배경이 지워집니다.

##  <a name="isconvertingvbx"></a>  COleControl::IsConvertingVBX

OLE 컨트롤의 특수 한 로드를 허용 합니다.

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>반환 값

컨트롤이 변환 되 고 있으면 0이 아닙니다. 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

VBX 컨트롤을 사용 하는 폼을 OLE 컨트롤을 사용 하는 폼으로 변환 하는 경우 OLE 컨트롤에 대 한 특수 로드 코드가 필요할 수 있습니다. 예를 들어 OLE 컨트롤의 인스턴스를 로드 하는 경우에서 `DoPropExchange` [PX_Font](persistence-of-ole-controls.md#px_font) 에 대 한 호출을 사용할 수 있습니다.

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

그러나 VBX 컨트롤에는 Font 개체가 없습니다. 각 글꼴 속성은 개별적으로 저장 되었습니다. 이 경우를 사용 `IsConvertingVBX` 하 여 다음 두 가지 경우를 구분 합니다.

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

또 다른 경우는 VBX 컨트롤이 소유 이진 데이터 (VBM_SAVEPROPERTY 메시지 처리기)를 저장 하 고 OLE 컨트롤에서 이진 데이터를 다른 형식으로 저장 하는 경우입니다. Ole 컨트롤이 VBX 컨트롤과 이전 버전과 호환 되도록 하려면 VBX 컨트롤 또는 OLE 컨트롤의 로드 여부를 구분 하 여 함수를 `IsConvertingVBX` 사용 하 여 이전 형식과 새 형식을 모두 읽을 수 있습니다.

컨트롤의 `DoPropExchange` 함수에서이 조건을 확인 하 고 true 이면 이전 예제와 같이이 변환과 관련 된 로드 코드를 실행할 수 있습니다. 컨트롤이 변환 되지 않는 경우 일반 로드 코드를 실행할 수 있습니다. 이 기능은 VBX에서 변환 되는 컨트롤에만 적용 됩니다.

##  <a name="isinvokeallowed"></a>  COleControl::IsInvokeAllowed

자동화 메서드 호출을 사용 합니다.

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>반환 값

컨트롤이 초기화 되었으면 0이 아닙니다. 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

프레임 워크의 `IDispatch::Invoke` 호출 `IsInvokeAllowed` 을 구현 하 여 지정 된 함수 (로 `dispid`식별 됨)가 호출 될 수 있는지 여부를 확인 합니다. OLE 컨트롤의 기본 동작은 컨트롤이 초기화 된 경우에만 자동화 메서드를 호출할 수 있도록 하는 것입니다. 그러나는 `IsInvokeAllowed` 가상 함수 이며, 필요한 경우 (예: 컨트롤이 자동화 서버로 사용 되는 경우) 재정의할 수 있습니다.

##  <a name="ismodified"></a>  COleControl::IsModified

컨트롤의 상태가 수정 되었는지 여부를 확인 합니다.

```
BOOL IsModified();
```

### <a name="return-value"></a>반환 값

컨트롤의 상태가 마지막으로 저장 된 이후 수정 된 경우 0이 아닙니다. 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

속성 값이 변경 되 면 컨트롤의 상태가 수정 됩니다.

##  <a name="isoptimizeddraw"></a>  COleControl::IsOptimizedDraw

컨테이너가 현재 그리기 작업에 대해 최적화 된 그리기를 지원 하는지 여부를 확인 합니다.

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>반환 값

컨테이너가 현재 그리기 작업에 대해 최적화 된 그리기를 지원 하면 TRUE이 고, 그렇지 않으면 FALSE입니다.

### <a name="remarks"></a>설명

최적화 된 그리기가 지원 되 면 그리기를 마칠 때 컨트롤에서 장치 컨텍스트로 이전 개체 (펜, 브러시, 글꼴 등)를 선택 하지 않아도 됩니다.

##  <a name="issubclassedcontrol"></a>  COleControl::IsSubclassedControl

컨트롤이 Windows 컨트롤을 서브 클래스 하는지 여부를 확인 하기 위해 프레임 워크에서 호출 됩니다.

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>반환 값

컨트롤이 서브클래싱된 경우 0이 아닌 값입니다. 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

OLE 컨트롤이 Windows 컨트롤을 서브 클래스 하는 경우이 함수를 재정의 하 고 TRUE를 반환 해야 합니다.

##  <a name="load"></a>  COleControl::Load

비동기적으로 로드 된 이전 데이터를 다시 설정 하 고 컨트롤의 비동기 속성의 새 로드를 시작 합니다.

```
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>매개 변수

*strNewPath*<br/>
비동기 컨트롤 속성의 절대 위치를 참조 하는 경로를 포함 하는 문자열에 대 한 포인터입니다.

*prop*<br/>
비동기 컨트롤 속성을 구현 하는 [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md) 개체입니다.

##  <a name="lockinplaceactive"></a>  COleControl::LockInPlaceActive

컨테이너가 컨트롤을 비활성화 하지 않도록 합니다.

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>매개 변수

*bLock*<br/>
컨트롤의 내부 활성 상태를 잠그면 TRUE이 고, 그렇지 않으면입니다. 잠금이 해제 되 면 FALSE입니다.

### <a name="return-value"></a>반환 값

잠금이 성공 하면 0이 아닌 값입니다. 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

완료 되 면 컨트롤의 모든 잠금이 컨트롤의 잠금 해제와 쌍을 이루어야 합니다. 이벤트를 발생 시키는 경우와 같이 짧은 기간 동안만 컨트롤을 잠가야 합니다.

##  <a name="onambientpropertychange"></a>  COleControl::OnAmbientPropertyChange

컨테이너의 앰비언트 속성 값이 변경 될 때 프레임 워크에서 호출 됩니다.

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>매개 변수

*dispID*<br/>
변경 된 앰비언트 속성의 디스패치 ID 이거나, 여러 속성이 변경 된 경우에는 DISPID_UNKNOWN입니다.

##  <a name="onappearancechanged"></a>  COleControl::OnAppearanceChanged

스톡 모양 속성 값이 변경 될 때 프레임 워크에서 호출 됩니다.

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>설명

이 속성이 변경 된 후 알림을 표시 하려면이 함수를 재정의 합니다. 기본 구현에서는를 `InvalidateControl`호출 합니다.

##  <a name="onbackcolorchanged"></a>  COleControl::OnBackColorChanged

스톡 BackColor 속성 값이 변경 될 때 프레임 워크에서 호출 됩니다.

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>설명

이 속성이 변경 된 후 알림을 표시 하려면이 함수를 재정의 합니다. 기본 구현에서는를 `InvalidateControl`호출 합니다.

##  <a name="onborderstylechanged"></a>  COleControl::OnBorderStyleChanged

스톡 BorderStyle 속성 값이 변경 될 때 프레임 워크에서 호출 됩니다.

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>설명

기본 구현에서는를 `InvalidateControl`호출 합니다.

이 속성이 변경 된 후 알림을 표시 하려면이 함수를 재정의 합니다.

##  <a name="onclick"></a>  COleControl::OnClick

마우스 단추를 클릭 하거나 DoClick 스톡 메서드가 호출 될 때 프레임 워크에서 호출 됩니다.

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>매개 변수

*iButton*<br/>
마우스 단추의 인덱스입니다. 다음 값 중 하나를 사용할 수 있습니다.

- LEFT_BUTTON 마우스 왼쪽 단추를 클릭 했습니다.

- 마우스 가운데 단추를 클릭 MIDDLE_BUTTON.

- 마우스 오른쪽 단추를 클릭 RIGHT_BUTTON.

### <a name="remarks"></a>설명

기본 구현에서는를 `COleControl::FireClick`호출 합니다.

기본 처리를 수정 하거나 확장 하려면이 멤버 함수를 재정의 합니다.

##  <a name="onclose"></a>  COleControl::OnClose

컨테이너가 컨트롤의 `IOleControl::Close` 함수를 호출 했을 때 프레임 워크에서 호출 됩니다.

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>매개 변수

*dwSaveOption*<br/>
로드 하기 전에 개체를 저장 해야 하는지 여부를 나타내는 플래그입니다. 유효한 값은

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>설명

기본적으로는 `OnClose` 컨트롤 개체가 수정 되었고 *dwsaveoption* 이 OLECLOSE_SAVEIFDIRTY 또는 OLECLOSE_PROMPTSAVE 인 경우이를 저장 합니다.

##  <a name="ondoverb"></a>  COleControl::OnDoVerb

컨테이너가 멤버 함수를 `IOleObject::DoVerb` 호출할 때 프레임 워크에서 호출 됩니다.

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>매개 변수

*iVerb*<br/>
호출 될 컨트롤 동사의 인덱스입니다.

*lpMsg*<br/>
동사가 호출 되 게 한 Windows 메시지에 대 한 포인터입니다.

*hWndParent*<br/>
컨트롤의 부모 창에 대 한 핸들입니다. 동사를 실행 하 여 창 또는 windows를 만든 경우 *hWndParent* 를 부모로 사용 해야 합니다.

*lpRect*<br/>
컨테이너에 상대적인 컨트롤의 좌표가 복사 될 RECT 구조체에 대 한 포인터입니다.

### <a name="return-value"></a>반환 값

호출에 성공 하면 0이 아닌 값입니다. 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

기본 구현에서는 ON_OLEVERB 및 ON_STDOLEVERB 메시지 맵 항목을 사용 하 여 호출할 적절 한 함수를 결정 합니다.

동사의 기본 처리를 변경 하려면이 함수를 재정의 합니다.

##  <a name="ondraw"></a>  COleControl::OnDraw

지정 된 장치 컨텍스트를 사용 하 여 지정 된 경계 사각형에 OLE 컨트롤을 그리기 위해 프레임 워크에서 호출 됩니다.

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>매개 변수

*pDC*<br/>
그리기가 발생 하는 장치 컨텍스트입니다.

*rcBounds*<br/>
테두리를 포함 하는 컨트롤의 사각형 영역입니다.

*rcInvalid*<br/>
잘못 된 컨트롤의 사각형 영역입니다.

### <a name="remarks"></a>설명

`OnDraw`는 일반적으로 화면 표시를 위해 호출 되며, 화면 장치 컨텍스트를 *pDC*로 전달 합니다. *Rcbounds* 매개 변수는 현재 매핑 모드를 기준으로 대상 장치 컨텍스트의 사각형을 식별 합니다. *Rcinvalid* 매개 변수가 잘못 된 실제 사각형입니다. 어떤 경우에는 *Rcbounds*보다 작은 영역입니다.

##  <a name="ondrawmetafile"></a>  COleControl::OnDrawMetafile

지정 된 메타 파일 장치 컨텍스트를 사용 하 여 지정 된 경계 사각형에 OLE 컨트롤을 그리기 위해 프레임 워크에서 호출 됩니다.

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>매개 변수

*pDC*<br/>
그리기가 발생 하는 장치 컨텍스트입니다.

*rcBounds*<br/>
테두리를 포함 하는 컨트롤의 사각형 영역입니다.

### <a name="remarks"></a>설명

기본 구현에서는 [OnDraw](#ondraw) 함수를 호출 합니다.

##  <a name="onedit"></a>  COleControl::OnEdit

컨트롤이 UI 활성화 되도록 합니다.

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>매개 변수

*lpMsg*<br/>
동사를 호출한 Windows 메시지에 대 한 포인터입니다.

*hWndParent*<br/>
컨트롤의 부모 창에 대 한 핸들입니다.

*lpRect*<br/>
컨테이너의 컨트롤에서 사용 하는 사각형에 대 한 포인터입니다.

### <a name="return-value"></a>반환 값

호출에 성공 하면 0이 아닌 값입니다. 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

이는 컨트롤의 OLEIVERB_UIACTIVATE 동사를 호출 하는 것과 동일한 효과를 가집니다.

이 함수는 일반적으로 ON_OLEVERB 메시지 맵 항목에 대 한 처리기 함수로 사용 됩니다. 이렇게 하면 컨트롤의 "개체" 메뉴에서 "편집" 동사를 사용할 수 있습니다. 예를 들어:

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

##  <a name="onenabledchanged"></a>  COleControl::OnEnabledChanged

스톡 Enabled 속성 값이 변경 될 때 프레임 워크에서 호출 됩니다.

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>설명

이 속성이 변경 된 후 알림을 표시 하려면이 함수를 재정의 합니다. 기본 구현에서는 [Invalidatecontrol](#invalidatecontrol)을 호출 합니다.

##  <a name="onenumverbs"></a>  COleControl::OnEnumVerbs

컨테이너가 멤버 함수를 `IOleObject::EnumVerbs` 호출할 때 프레임 워크에서 호출 됩니다.

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>매개 변수

*ppenumOleVerb*<br/>
컨트롤의 동사를 `IEnumOLEVERB` 열거 하는 개체에 대 한 포인터입니다.

### <a name="return-value"></a>반환 값

동사를 사용할 수 있는 경우 0이 아닙니다. 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

기본 구현에서는 메시지 맵의 ON_OLEVERB 항목을 열거 합니다.

동사를 열거 하는 기본 방법을 변경 하려면이 함수를 재정의 합니다.

##  <a name="oneventadvise"></a>  COleControl::OnEventAdvise

이벤트 처리기가 OLE 컨트롤에 연결 되거나 연결 해제 될 때 프레임 워크에서 호출 됩니다.

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>매개 변수

*bAdvise*<br/>
TRUE는 이벤트 처리기가 컨트롤에 연결 되었음을 나타냅니다. FALSE는 이벤트 처리기가 컨트롤에서 분리 되었음을 나타냅니다.

##  <a name="onfontchanged"></a>  COleControl::OnFontChanged

스톡 글꼴 속성 값이 변경 될 때 프레임 워크에서 호출 됩니다.

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>설명

기본 구현에서는를 `COleControl::InvalidateControl`호출 합니다. 컨트롤이 Windows 컨트롤을 서브클래싱하는 경우에는 기본 구현 에서도 WM_SETFONT 메시지를 컨트롤의 창으로 보냅니다.

이 속성이 변경 된 후 알림을 표시 하려면이 함수를 재정의 합니다.

### <a name="example"></a>예제

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

##  <a name="onforecolorchanged"></a>  COleControl::OnForeColorChanged

스톡 ForeColor 속성 값이 변경 될 때 프레임 워크에서 호출 됩니다.

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>설명

기본 구현에서는를 `InvalidateControl`호출 합니다.

이 속성이 변경 된 후 알림을 표시 하려면이 함수를 재정의 합니다.

##  <a name="onfreezeevents"></a>  COleControl::OnFreezeEvents

컨테이너가를 호출한 `IOleControl::FreezeEvents`후 프레임 워크에서 호출 됩니다.

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>매개 변수

*bFreeze*<br/>
컨트롤의 이벤트 처리가 고정 되어 있으면 TRUE이 고, 그렇지 않으면입니다. 그렇지 않으면 FALSE입니다.

### <a name="remarks"></a>설명

기본 구현은 아무 작업도 수행하지 않습니다.

이벤트 처리가 고정 또는 고정 해제 될 때 추가 동작을 원하는 경우이 함수를 재정의 합니다.

##  <a name="ongetcolorset"></a>  COleControl::OnGetColorSet

컨테이너가 멤버 함수를 `IViewObject::GetColorSet` 호출할 때 프레임 워크에서 호출 됩니다.

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>매개 변수

*ptd*<br/>
그림이 렌더링 되어야 하는 대상 장치를 가리킵니다. 이 값이 NULL 이면 그림이 기본 대상 장치 (일반적으로 디스플레이 장치)에 대해 렌더링 됩니다.

*hicTargetDev*<br/>
*Ptd*로 표시 되는 대상 장치에 대 한 정보 컨텍스트를 지정 합니다. 이 매개 변수는 장치 컨텍스트가 될 수 있지만 반드시 그럴 필요는 없습니다. *Ptd* 가 Null 이면 *hicTargetDev* 도 null 이어야 합니다.

*ppColorSet*<br/>
사용할 색 집합을 복사 해야 하는 위치에 대 한 포인터입니다. 함수에서 색 집합을 반환 하지 않는 경우 NULL이 반환 됩니다.

### <a name="return-value"></a>반환 값

올바른 색 집합이 반환 되 면 0이 아닌 값이 반환 됩니다. 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

컨테이너는이 함수를 호출 하 여 OLE 컨트롤을 그리는 데 필요한 모든 색을 가져옵니다. 컨테이너는 전체 색상표를 설정 하는 데 필요한 색과 함께 가져온 색 집합을 사용할 수 있습니다. 기본 구현에서는 FALSE를 반환 합니다.

이 요청을 특수 하 게 처리 하려면이 함수를 재정의 합니다.

##  <a name="ongetcontrolinfo"></a>  COleControl::OnGetControlInfo

컨트롤의 컨테이너가 컨트롤에 대 한 정보를 요청할 때 프레임 워크에서 호출 됩니다.

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>매개 변수

*pControlInfo*<br/>
채울 [CONTROLINFO](/windows/win32/api/ocidl/ns-ocidl-controlinfo) 구조체에 대 한 포인터입니다.

### <a name="remarks"></a>설명

이 정보는 주로 컨트롤의 니모닉 키에 대 한 설명으로 구성 됩니다. 기본 구현에서는 *pControlInfo* 를 기본 정보로 채웁니다.

컨트롤에서 니모닉 키를 처리 해야 하는 경우이 함수를 재정의 합니다.

##  <a name="ongetdisplaystring"></a>  COleControl::OnGetDisplayString

*Dispid*로 식별 되는 속성의 현재 값을 나타내는 문자열을 가져오기 위해 프레임 워크에서 호출 됩니다.

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>매개 변수

*dispid*<br/>
컨트롤의 속성에 대한 디스패치 ID입니다.

*strValue*<br/>
문자열이 반환 되는 [CString](../../atl-mfc-shared/reference/cstringt-class.md) 개체에 대 한 참조입니다.

### <a name="return-value"></a>반환 값

문자열이 Strvalue에 반환 되 면 0이 아닌 *값이 고,* 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

컨트롤에 값을 직접 문자열로 변환할 수 없고 컨테이너 제공 속성 브라우저에 속성의 값을 표시 하려는 속성이 있는 경우이 함수를 재정의 합니다.

##  <a name="ongetinplacemenu"></a>  COleControl::OnGetInPlaceMenu

컨테이너의 기존 메뉴에 병합 될 메뉴를 가져오기 위해 컨트롤이 UI 활성화 될 때 프레임 워크에서 호출 됩니다.

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>반환 값

컨트롤의 메뉴에 대 한 핸들입니다. 컨트롤에가 없으면 NULL입니다. 기본 구현에서는 NULL을 반환 합니다.

### <a name="remarks"></a>설명

OLE 리소스 병합에 대 한 자세한 내용은 [메뉴 및 리소스 (OLE)](../../mfc/menus-and-resources-ole.md)문서를 참조 하세요.

##  <a name="ongetnaturalextent"></a>  COleControl::OnGetNaturalExtent

컨테이너 `IViewObjectEx::GetNaturalExtent` 요청에 대 한 응답으로 프레임 워크에서 호출 됩니다.

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>매개 변수

*dwAspect*<br/>
개체를 표현할 방법을 지정합니다. 표현에는 콘텐츠, 아이콘, 축소판 그림 또는 인쇄 된 문서가 포함 됩니다. 유효한 값은 열거형 [Dvaspect](/windows/win32/api/wtypes/ne-wtypes-dvaspect) 또는 DVASPECT2에서 가져옵니다.

*lindex*<br/>
관련 된 개체의 부분입니다. 현재-1만 유효 합니다.

*ptd*<br/>
개체의 크기를 반환할 대상 장치를 정의 하는 [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) 구조체를 가리킵니다.

*hicTargetDev*<br/>
개체가 장치 메트릭을 추출 하 고 장치 기능을 테스트 하는 데 사용할 수 있는 *ptd* 매개 변수로 표시 되는 대상 장치에 대 한 정보 컨텍스트를 지정 합니다. *Ptd* 가 NULL 인 경우 개체는 *hicTargetDev* 매개 변수에서 값을 무시 해야 합니다.

*pExtentInfo*<br/>
크기 조정 데이터 `DVEXTENTINFO` 를 지정 하는 구조를 가리킵니다. 구조 `DVEXTENTINFO` 는 다음과 같습니다.

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

구조체 멤버 `dwExtentMode` 는 다음 두 값 중 하나를 사용할 수 있습니다.

- DVEXTENT_CONTENT는 컨트롤의 크기를 정확 하 게 맞추기 위해 컨트롤의 크기 (맞춤-크기)를 결정 합니다.

- 크기를 조정할 때 DVEXTENT_INTEGRAL 컨트롤에 제안 된 크기 전달

*psizel*<br/>
컨트롤에 의해 반환 되는 데이터 크기 조정을 가리킵니다. 반환 된 크기 조정 데이터는 조정 되지 않은 모든 차원에 대해-1로 설정 됩니다.

### <a name="return-value"></a>반환 값

성공적으로 반환 하거나 크기를 조정 하는 경우 0이 아닙니다. 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

`DVEXTENTINFO` 구조체에서 제안 된 크기 및 범위 모드와 가장 가까운 개체의 표시 크기를 반환 하려면이 함수를 재정의 합니다. 기본 구현에서는 FALSE를 반환 하 고 크기를 조정 하지 않습니다.

##  <a name="ongetpredefinedstrings"></a>  COleControl::OnGetPredefinedStrings

속성에 사용할 수 있는 값을 나타내는 미리 정의 된 문자열 집합을 가져오기 위해 프레임 워크에서 호출 됩니다.

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>매개 변수

*dispid*<br/>
컨트롤의 속성에 대한 디스패치 ID입니다.

*pStringArray*<br/>
반환 값으로 채워질 문자열 배열입니다.

*pCookieArray*<br/>
반환 값으로 채워질 DWORD 배열입니다.

### <a name="return-value"></a>반환 값

요소가 *Pstringarray* 및 *pCookieArray*에 추가 된 경우 0이 아닙니다.

### <a name="remarks"></a>설명

컨트롤에 문자열로 표현할 수 있는 가능한 값 집합이 포함 된 속성이 있는 경우이 함수를 재정의 합니다. *Pstringarray*에 추가 된 각 요소에 대해 해당 "cookie" 요소를 pCookieArray에 추가 해야 합니다 *.* 이러한 "쿠키" 값은 나중에 프레임 워크에서 `COleControl::OnGetPredefinedValue` 함수에 전달 될 수 있습니다.

##  <a name="ongetpredefinedvalue"></a>  COleControl::OnGetPredefinedValue

이전에 재정의 `COleControl::OnGetPredefinedStrings`에서 반환 된 미리 정의 된 문자열 중 하나에 해당 하는 값을 가져오기 위해 프레임 워크에서 호출 됩니다.

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>매개 변수

*dispid*<br/>
컨트롤의 속성에 대한 디스패치 ID입니다.

*dwCookie*<br/>
재정의에서 이전에 반환 된 쿠키 값입니다 `COleControl::OnGetPredefinedStrings`.

*lpvarOut*<br/>
속성 값이 `VARIANT` 반환 되는 구조에 대 한 포인터입니다.

### <a name="return-value"></a>반환 값

값이 *Lpvarout*에서 반환 된 경우 0이 아닙니다. 그렇지 않으면 0입니다.

##  <a name="ongetviewextent"></a>  COleControl::OnGetViewExtent

컨테이너의 [IViewObject2:: GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) 요청에 대 한 응답으로 프레임 워크에서 호출 됩니다.

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>매개 변수

*dwDrawAspect*<br/>
표시할 개체의 폼 또는 측면을 설명 하는 DWORD입니다. 유효한 값은 열거형 [Dvaspect](/windows/win32/api/wtypes/ne-wtypes-dvaspect) 또는 DVASPECT2에서 가져옵니다.

*lindex*<br/>
관련 된 개체의 부분입니다. 현재-1만 유효 합니다.

*ptd*<br/>
개체의 크기를 반환할 대상 장치를 정의 하는 [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) 구조체를 가리킵니다.

*lpsizel*<br/>
개체의 크기가 반환 되는 위치를 가리킵니다.

### <a name="return-value"></a>반환 값

익스텐트 정보가 성공적으로 반환 되 면 0이 아닌 값이 반환 됩니다. 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

컨트롤에서 2 패스 그리기를 사용 하 고 불투명 부분과 투명 부분에 서로 다른 차원이 있는 경우이 함수를 재정의 합니다.

##  <a name="ongetviewrect"></a>  COleControl::OnGetViewRect

컨테이너 `IViewObjectEx::GetRect` 요청에 대 한 응답으로 프레임 워크에서 호출 됩니다.

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>매개 변수

*dwAspect*<br/>
표시할 개체의 폼 또는 측면을 설명 하는 DWORD입니다. 유효한 값은 다음 열거형 [Dvaspect](/windows/win32/api/wtypes/ne-wtypes-dvaspect) 또는 DVASPECT2에서 가져옵니다.

- 전체 개체의 DVASPECT_CONTENT 경계 사각형입니다. 에서 `GetViewExtent`반환 하는 범위와 같은 개체의 원점 및 크기의 왼쪽 위 모퉁이 *입니다.*

- 사각형 불투명 지역이 있는 DVASPECT_OPAQUE 개체는 해당 사각형을 반환 합니다. 나머지는 실패 합니다.

- 투명 하거나 불규칙 한 부분을 모두 포함 하는 DVASPECT_TRANSPARENT 사각형입니다.

*pRect*<br/>
개체를 그려야 하는 사각형을 지정 하는 [RECTL](/previous-versions/dd162907\(v=vs.85\)) 구조체를 가리킵니다. 이 매개 변수는 개체의 위치 지정 및 늘이기를 제어 합니다.

### <a name="return-value"></a>반환 값

개체로 크기가 지정 된 사각형이 성공적으로 반환 되 면 0이 아닌 값이 반환 됩니다. 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

개체의 크기는에 의해 특정 `OnGetViewRect` 위치에서 시작 하는 사각형으로 변환 됩니다. 기본값은 표시의 왼쪽 위 모퉁이입니다. 컨트롤에서 2 패스 그리기를 사용 하 고 불투명 부분과 투명 부분에 서로 다른 차원이 있는 경우이 함수를 재정의 합니다.

##  <a name="ongetviewstatus"></a>  COleControl::OnGetViewStatus

컨테이너 `IViewObjectEx::GetViewStatus` 요청에 대 한 응답으로 프레임 워크에서 호출 됩니다.

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>반환 값

성공 하면 VIEWSTATUS 열거형 값 중 하나입니다. 그렇지 않으면 0입니다. 가능한 값은 다음을 조합한 것입니다.

|||
|-|-|
|VIEWSTATUS_OPAQUE|개체가 완전히 불투명 합니다. 이 비트가 설정 되지 않은 경우 개체는 투명 한 부분을 포함 합니다. 이 비트는 콘텐츠 관련 면에만 적용 되 고 DVASPECT_ICON 또는 DVASPECT_DOCPRINT에는 적용 되지 않습니다.|
|VIEWSTATUS_SOLIDBKGND|개체에 브러시 패턴이 아닌 단색으로 구성 된 단색 배경이 있습니다. 이 비트는 VIEWSTATUS_OPAQUE가 설정 되어 있고 콘텐츠 관련 측면에만 적용 되 고 DVASPECT_ICON 또는 DVASPECT_DOCPRINT에는 적용 되지 않는 경우에만 의미가 있습니다.|
|VIEWSTATUS_DVASPECTOPAQUE|개체가 DVASPECT_OPAQUE을 지원 합니다. 이 측면에서 그리기 측면을 매개 변수로 사용 하는 모든 IViewObjectEx 메서드를 호출할 수 있습니다.|
|VIEWSTATUS_DVASPECTTRANSPARENT|개체가 DVASPECT_TRANSPARENT을 지원 합니다. 이 `IViewObjectEx` 측면에서 드로잉 측면을 매개 변수로 사용 하는 모든 메서드를 호출할 수 있습니다.|

### <a name="remarks"></a>설명

컨트롤에서 2 패스 그리기를 사용 하는 경우이 함수를 재정의 합니다. 기본 구현에서는 VIEWSTATUS_OPAQUE를 반환 합니다.

##  <a name="onhidetoolbars"></a>  COleControl::OnHideToolBars

컨트롤이 UI 비활성화 될 때 프레임 워크에서 호출 됩니다.

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>설명

구현에서는에 의해 `OnShowToolbars`표시 되는 모든 도구 모음을 숨깁니다.

##  <a name="oninactivemousemove"></a>  COleControl::OnInactiveMouseMove

WM_MOUSEMOVE 메시지 수신 시 마우스 포인터 아래의 비활성 개체에 대 한 컨테이너에 의해 호출 됩니다.

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>매개 변수

*lprcBounds*<br/>
포함 하는 창의 클라이언트 좌표에 있는 개체 경계 사각형입니다. WM_MOUSEMOVE 메시지를 받았을 때 개체에 정확한 위치와 크기를 알려 줍니다.

*x*<br/>
포함 하는 창의 클라이언트 좌표에서 마우스 위치의 x 좌표입니다.

*y*<br/>
포함 하는 창의 클라이언트 좌표에서 마우스 위치의 y 좌표입니다.

*dwKeyState*<br/>
키보드에서 키보드 보조키의 현재 상태를 식별 합니다. 유효한 값은 MK_CONTROL, MK_SHIFT, MK_ALT, MK_BUTTON, MK_LBUTTON, MK_MBUTTON 및 MK_RBUTTON 플래그의 조합일 수 있습니다.

### <a name="remarks"></a>설명

Window 클라이언트 좌표 (픽셀)는 마우스 커서 위치를 전달 하는 데 사용 됩니다. 동일한 좌표계에서 개체의 경계 사각형을 전달 하 여이 작업을 수행할 수 있습니다.

##  <a name="oninactivesetcursor"></a>  COleControl::OnInactiveSetCursor

WM_SETCURSOR 메시지 수신 시 마우스 포인터 아래의 비활성 개체에 대 한 컨테이너에 의해 호출 됩니다.

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>매개 변수

*lprcBounds*<br/>
포함 하는 창의 클라이언트 좌표에 있는 개체 경계 사각형입니다. WM_SETCURSOR 메시지를 받았을 때 개체에 정확한 위치와 크기를 알려 줍니다.

*x*<br/>
포함 하는 창의 클라이언트 좌표에서 마우스 위치의 x 좌표입니다.

*y*<br/>
포함 하는 창의 클라이언트 좌표에서 마우스 위치의 y 좌표입니다.

*dwMouseMsg*<br/>
WM_SETCURSOR 발생 한 마우스 메시지의 식별자입니다.

*bSetAlways*<br/>
개체에서 커서를 설정 해야 하는지 여부를 지정 합니다. TRUE 이면 개체가 커서를 설정 해야 합니다. FALSE 이면 커서는 커서를 설정할 필요가 없으며, 해당 하는 경우 S_FALSE를 반환 해야 합니다.

### <a name="return-value"></a>반환 값

성공하면 0이 아니고, 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

Window 클라이언트 좌표 (픽셀)는 마우스 커서 위치를 전달 하는 데 사용 됩니다. 동일한 좌표계에서 개체의 경계 사각형을 전달 하 여이 작업을 수행할 수 있습니다.

##  <a name="onkeydownevent"></a>  COleControl::OnKeyDownEvent

스톡 KeyDown 이벤트가 처리 된 후 프레임 워크에서 호출 됩니다.

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>매개 변수

*nChar*<br/>
누른 키의 가상 키 코드 값입니다. 표준 가상 키 코드의 목록은 Winuser.h를 참조 하세요.

*nShiftState*<br/>
에는 다음 플래그의 조합이 포함 되어 있습니다.

- SHIFT_MASK 동작을 수행 하는 동안 SHIFT 키를 눌렀습니다.

- CTRL_MASK 동작 중에 CTRL 키가 눌러져 있습니다.

- ALT_MASK 동작을 수행 하는 동안 ALT 키를 눌렀습니다.

### <a name="remarks"></a>설명

이벤트가 발생 한 후 컨트롤에서 키 정보에 액세스 해야 하는 경우이 함수를 재정의 합니다.

##  <a name="onkeypressevent"></a>  COleControl::OnKeyPressEvent

스톡 KeyPress 이벤트가 발생 한 후 프레임 워크에서 호출 됩니다.

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>매개 변수

*nChar*<br/>
누른 키의 가상 키 코드 값을 포함 합니다. 표준 가상 키 코드의 목록은 Winuser.h를 참조 하세요.

### <a name="remarks"></a>설명

*NChar* 값이 컨테이너에 의해 수정 된 것일 수 있습니다.

이 이벤트가 발생 한 후 알림을 표시 하려면이 함수를 재정의 합니다.

##  <a name="onkeyupevent"></a>  COleControl::OnKeyUpEvent

스톡 KeyDown 이벤트가 처리 된 후 프레임 워크에서 호출 됩니다.

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>매개 변수

*nChar*<br/>
누른 키의 가상 키 코드 값입니다. 표준 가상 키 코드의 목록은 Winuser.h를 참조 하세요.

*nShiftState*<br/>
에는 다음 플래그의 조합이 포함 되어 있습니다.

- SHIFT_MASK 동작을 수행 하는 동안 SHIFT 키를 눌렀습니다.

- CTRL_MASK 동작 중에 CTRL 키가 눌러져 있습니다.

- ALT_MASK 동작을 수행 하는 동안 ALT 키를 눌렀습니다.

### <a name="remarks"></a>설명

이벤트가 발생 한 후 컨트롤에서 키 정보에 액세스 해야 하는 경우이 함수를 재정의 합니다.

##  <a name="onmappropertytopage"></a>  COleControl::OnMapPropertyToPage

지정 된 속성의 편집을 구현 하는 속성 페이지의 클래스 ID를 가져오기 위해 프레임 워크에서 호출 됩니다.

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>매개 변수

*dispid*<br/>
컨트롤의 속성에 대한 디스패치 ID입니다.

*lpclsid*<br/>
클래스 ID를 `CLSID` 반환 하는 구조체에 대 한 포인터입니다.

*pbPageOptional*<br/>
지정 된 속성 페이지 사용이 선택 사항 인지 여부를 나타내는 표시기를 반환 합니다.

### <a name="return-value"></a>반환 값

*Lpclsid*에 클래스 ID가 반환 되 면 0이 아닌 값입니다. 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

컨테이너의 속성 브라우저에서 컨트롤의 속성 페이지를 호출 하는 방법을 제공 하려면이 함수를 재정의 합니다.

##  <a name="onmnemonic"></a>  COleControl::OnMnemonic

컨테이너에서 OLE 컨트롤의 니모닉 키를 눌렀음을 감지 했을 때 프레임 워크에서 호출 됩니다.

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>매개 변수

*pMsg*<br/>
니모닉 키 누르기로 생성되는 Windows 메시지에 대한 포인터입니다.

##  <a name="onproperties"></a>  COleControl::OnProperties

컨테이너에서 컨트롤의 속성 동사가 호출 될 때 프레임 워크에서 호출 됩니다.

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>매개 변수

*lpMsg*<br/>
동사를 호출한 Windows 메시지에 대 한 포인터입니다.

*hWndParent*<br/>
컨트롤의 부모 창에 대 한 핸들입니다.

*lpRect*<br/>
컨테이너의 컨트롤에서 사용 하는 사각형에 대 한 포인터입니다.

### <a name="return-value"></a>반환 값

호출에 성공 하면 0이 아닌 값입니다. 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

기본 구현에서는 모달 속성 대화 상자를 표시 합니다.

이 함수를 사용 하 여 컨트롤의 속성 페이지가 표시 되도록 할 수도 있습니다. *HWndParent* 매개 변수에 컨트롤 부모의 `OnProperties` 핸들을 전달 하 여 함수를 호출 합니다. 이 경우 *Lpmsg* 및 *lpRect* 매개 변수의 값은 무시 됩니다.

##  <a name="onqueryhitpoint"></a>  COleControl::OnQueryHitPoint

컨테이너 `IViewObjectEx::QueryHitPoint` 요청에 대 한 응답으로 프레임 워크에서 호출 됩니다.

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>매개 변수

*dwAspect*<br/>
개체를 나타내는 방법을 지정 합니다. 유효한 값은 열거형 [Dvaspect](/windows/win32/api/wtypes/ne-wtypes-dvaspect) 또는 DVASPECT2에서 가져옵니다.

*pRectBounds*<br/>
OLE 컨트롤 클라이언트 `RECT` 영역의 경계 사각형을 지정 하는 구조체에 대 한 포인터입니다.

*ptlLoc*<br/>
적중에 대해 `POINT` 확인할 점을 지정 하는 구조체에 대 한 포인터입니다. 지점은 OLE 클라이언트 영역 좌표로 지정 됩니다.

*lCloseHint*<br/>
적중에 대해 확인 된 지점에 "close"를 정의 하는 거리입니다.

*pHitResult*<br/>
적중 쿼리의 결과에 대 한 포인터입니다. 다음 값 중 하나입니다.

- HITRESULT_OUTSIDE *Ptlloc* 가 OLE 개체의 외부에 있으며 닫히지 않습니다.

- HITRESULT_TRANSPARENT *Ptlloc* 는 OLE 개체의 범위 내에 있지만 이미지와는 근접 하지 않습니다. 예를 들어 투명 원 가운데의 점은 HITRESULT_TRANSPARENT 수 있습니다.

- HITRESULT_CLOSE *Ptlloc* 가 OLE 개체 내부 또는 외부에 있지만, 내부에서 고려 될 수 있을 만큼 개체가 가까이 있습니다. 소형, 씬 또는 상세 개체는이 값을 사용할 수 있습니다. 점이 개체의 경계 사각형 외부에 있는 경우에도 여전히 가까이 있을 수 있습니다 .이는 작은 개체를 적중 하는 데 필요 합니다.

- HITRESULT_HIT *Ptlloc* 는 개체의 이미지 내에 있습니다.

### <a name="return-value"></a>반환 값

적중 결과가 성공적으로 반환 되 면 0이 아닌 값이 반환 됩니다. 그렇지 않으면 0입니다. 적중은 OLE 컨트롤 표시 영역과 겹칩니다.

### <a name="remarks"></a>설명

개체의 표시 사각형이 지정 된 지점 (지점 적중)과 겹치는 지 여부를 쿼리 합니다. `QueryHitPoint`사각형이 아닌 개체에 대 한 적중 테스트를 위해 재정의할 수 있습니다.

##  <a name="onqueryhitrect"></a>  COleControl::OnQueryHitRect

컨테이너 `IViewObjectEx::QueryHitRect` 요청에 대 한 응답으로 프레임 워크에서 호출 됩니다.

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>매개 변수

*dwAspect*<br/>
개체를 표현할 방법을 지정합니다. 유효한 값은 열거형 [Dvaspect](/windows/win32/api/wtypes/ne-wtypes-dvaspect) 또는 DVASPECT2에서 가져옵니다.

*pRectBounds*<br/>
OLE 컨트롤 클라이언트 `RECT` 영역의 경계 사각형을 지정 하는 구조체에 대 한 포인터입니다.

*prcLoc*<br/>
개체의 왼쪽 `RECT` 위 모퉁이를 기준으로 적중을 확인할 사각형을 지정 하는 구조에 대 한 포인터입니다 (개체 사각형과 겹치기).

*lCloseHint*<br/>
사용되지 않습니다.

*pHitResult*<br/>
적중 쿼리의 결과에 대 한 포인터입니다. 다음 값 중 하나입니다.

- HITRESULT_OUTSIDE OLE 개체에 의해 사각형이 적중 하는 점이 없습니다.

- HITRESULT_HIT는 사각형에서 하나 이상의 점이 개체에서 적중 될 수 있습니다.

### <a name="return-value"></a>반환 값

적중 결과가 성공적으로 반환 되 면 0이 아닌 값이 반환 됩니다. 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

개체의 표시 사각형이 지정 된 사각형의 모든 지점과 겹치는 지 여부를 쿼리 합니다 (사각형 적중). `QueryHitRect`사각형이 아닌 개체에 대 한 적중 테스트를 위해 재정의할 수 있습니다.

##  <a name="onrenderdata"></a>  COleControl::OnRenderData

지정 된 형식의 데이터를 검색 하기 위해 프레임 워크에서 호출 됩니다.

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>매개 변수

*lpFormatEtc*<br/>
정보를 요청 하는 형식을 지정 하는 [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) 구조체를 가리킵니다.

*lpStgMedium*<br/>
데이터가 반환 되는 [STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1) 구조체를 가리킵니다.

### <a name="return-value"></a>반환 값

성공하면 0이 아니고, 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

지정 된 형식은 이전에 지연 된 렌더링을 위해 [delayrenderdata](../../mfc/reference/coledatasource-class.md#delayrenderdata) 또는 [delayrenderfiledata](../../mfc/reference/coledatasource-class.md#delayrenderfiledata) 멤버 함수를 사용 하 여 컨트롤 개체에 배치 되었습니다. 이 함수의 기본 구현은 제공 된 저장소 `OnRenderFileData` 미디어가 `OnRenderGlobalData`파일 또는 메모리 일 경우 각각 또는를 호출 합니다. 요청 된 형식이 CF_METAFILEPICT 또는 영구 속성 집합 형식인 경우 기본 구현은 적절 한 데이터를 렌더링 하 고 0이 아닌 값을 반환 합니다. 그렇지 않으면 0을 반환 하 고 아무 작업도 수행 하지 않습니다.

*> lpStgMedium tymed* 가 TYMED_NULL 인 경우 STGMEDIUM을 할당 하 고 *lpFormatEtc-> tymed*에 지정 된 대로 채워야 합니다. TYMED_NULL 않는 경우 데이터와 함께 STGMEDIUM를 채워야 합니다.

요청 된 형식 및 중간에 데이터를 제공 하려면이 함수를 재정의 합니다. 데이터에 따라이 함수의 다른 버전 중 하나를 대신 재정의할 수 있습니다. 데이터가 작고 크기가 고정 되어 있으면를 재정의 `OnRenderGlobalData`합니다. 데이터가 파일에 있거나 가변 크기인 경우를 재정의 `OnRenderFileData`합니다.

자세한 내용은 Windows SDK의 `FORMATETC` 및 `STGMEDIUM` 구조를 참조 하세요.

##  <a name="onrenderfiledata"></a>  COleControl::OnRenderFileData

저장소 미디어가 파일인 경우 지정 된 형식으로 데이터를 검색 하기 위해 프레임 워크에서 호출 됩니다.

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>매개 변수

*lpFormatEtc*<br/>
정보를 요청 하는 형식을 지정 하는 [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) 구조체를 가리킵니다.

*pFile*<br/>
데이터가 렌더링 될 [CFile](../../mfc/reference/cfile-class.md) 개체를 가리킵니다.

### <a name="return-value"></a>반환 값

성공하면 0이 아니고, 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

지정 된 형식은 이전에 지연 렌더링을 위해 [Delayrenderdata](../../mfc/reference/coledatasource-class.md#delayrenderdata) 멤버 함수를 사용 하 여 컨트롤 개체에 배치 되었습니다. 이 함수의 기본 구현은 단순히 FALSE를 반환 합니다.

요청 된 형식 및 중간에 데이터를 제공 하려면이 함수를 재정의 합니다. 데이터에 따라이 함수의 다른 버전 중 하나를 대신 재정의 하는 것이 좋습니다. 여러 저장소 미디어를 처리 하려면를 재정의 `OnRenderData`합니다. 데이터가 파일에 있거나 가변 크기인 경우를 재정의 `OnRenderFileData`합니다.

자세한 내용은 Windows SDK `FORMATETC` 구조를 참조 하세요.

##  <a name="onrenderglobaldata"></a>  COleControl::OnRenderGlobalData

지정 된 저장 미디어가 전역 메모리 인 경우 지정 된 형식의 데이터를 검색 하기 위해 프레임 워크에서 호출 됩니다.

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>매개 변수

*lpFormatEtc*<br/>
정보를 요청 하는 형식을 지정 하는 [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) 구조체를 가리킵니다.

*phGlobal*<br/>
데이터가 반환 될 전역 메모리의 핸들을 가리킵니다. 메모리가 할당 되지 않은 경우이 매개 변수는 NULL이 될 수 있습니다.

### <a name="return-value"></a>반환 값

성공하면 0이 아니고, 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

지정 된 형식은 이전에 지연 렌더링을 위해 [Delayrenderdata](../../mfc/reference/coledatasource-class.md#delayrenderdata) 멤버 함수를 사용 하 여 컨트롤 개체에 배치 되었습니다. 이 함수의 기본 구현은 단순히 FALSE를 반환 합니다.

*Phglobal* 이 NULL 인 경우 새 HGLOBAL을 할당 하 고 *phglobal*에 반환 해야 합니다. 그렇지 않으면 *Phglobal* 로 지정 된 HGLOBAL 데이터를 채워야 합니다. HGLOBAL에 배치 되는 데이터의 양은 메모리 블록의 현재 크기를 초과 하면 안 됩니다. 또한 블록을 더 큰 크기에 다시 할당할 수 없습니다.

요청 된 형식 및 중간에 데이터를 제공 하려면이 함수를 재정의 합니다. 데이터에 따라이 함수의 다른 버전 중 하나를 대신 재정의할 수 있습니다. 여러 저장소 미디어를 처리 하려면를 재정의 `OnRenderData`합니다. 데이터가 파일에 있거나 가변 크기인 경우를 재정의 `OnRenderFileData`합니다.

자세한 내용은 Windows SDK `FORMATETC` 구조를 참조 하세요.

##  <a name="onresetstate"></a>  COleControl::OnResetState

컨트롤의 속성을 기본값으로 설정 해야 할 때 프레임 워크에서 호출 됩니다.

```
virtual void OnResetState();
```

### <a name="remarks"></a>설명

기본 구현에서는 속성을 기본값으로 설정 하는 `CPropExchange` 개체를 전달 하 여 [dopropexchange](#dopropexchange)를 호출 합니다.

컨트롤 작성자는이 재정의 가능에서 OLE 컨트롤에 대 한 초기화 코드를 삽입할 수 있습니다. 이 함수는 `IPersistStream::Load` 또는 `IPersistStorage::Load`를 먼저 호출하지 않고 [IPersistStream::load](/windows/win32/api/objidl/nf-objidl-ipersiststream-load) 또는 [IPersistStorage::Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load)가 실패하거나[IPersistStreamInit::InitNew](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-initnew) 또는 [IPersistStorage::InitNew](/windows/win32/api/objidl/nf-objidl-ipersiststorage-initnew)가 호출될 때 호출됩니다.

##  <a name="onsetclientsite"></a>  COleControl::OnSetClientSite

컨테이너가 컨트롤의 `IOleControl::SetClientSite` 함수를 호출 했을 때 프레임 워크에서 호출 됩니다.

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>설명

기본적 `OnSetClientSite` 으로는 데이터 경로 속성이 로드 되는지 여부를 확인 하 고, 있는 경우를 `DoDataPathPropExchange`호출 합니다.

이 알림의 특수 처리를 수행 하려면이 함수를 재정의 합니다. 특히이 함수의 재정의는 기본 클래스를 호출 해야 합니다.

##  <a name="onsetdata"></a>  COleControl::OnSetData

컨트롤의 데이터를 지정 된 데이터로 바꾸기 위해 프레임 워크에서 호출 됩니다.

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>매개 변수

*lpFormatEtc*<br/>
데이터의 형식을 지정 하는 [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) 구조체에 대 한 포인터입니다.

*lpStgMedium*<br/>
데이터가 있는 [STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1) 구조체에 대 한 포인터입니다.

*bRelease*<br/>
컨트롤에서 저장소 미디어를 해제 해야 하면 TRUE이 고, 그렇지 않으면입니다. 컨트롤에서 저장 미디어를 해제 하지 않아야 하면 FALSE입니다.

### <a name="return-value"></a>반환 값

성공하면 0이 아니고, 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

데이터가 영구 속성 집합 형식인 경우 기본 구현은 컨트롤의 상태를 적절 하 게 수정 합니다. 그렇지 않으면 기본 구현은 아무 작업도 수행 하지 않습니다. *BRelease* 가 TRUE 이면를 `ReleaseStgMedium` 호출 하면이 고, 그렇지 않으면입니다.

컨트롤의 데이터를 지정 된 데이터로 바꾸려면이 함수를 재정의 합니다.

자세한 내용은 Windows SDK의 `FORMATETC` 및 `STGMEDIUM` 구조를 참조 하세요.

##  <a name="onsetextent"></a>  COleControl::OnSetExtent

[IOleObject:: setextent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent)호출의 결과로 컨트롤의 범위를 변경 해야 할 때 프레임 워크에서 호출 됩니다.

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>매개 변수

*lpSizeL*<br/>
정수 (long) `SIZEL` 를 사용 하 여 컨트롤의 너비와 높이를 나타내는 구조체에 대 한 포인터로, HIMETRIC 단위로 표현 됩니다.

### <a name="return-value"></a>반환 값

크기 변경이 허용 된 경우 0이 아닙니다. 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

기본 구현은 컨트롤 범위의 크기 조정을 처리 합니다. 컨트롤이 내부에서 활성화 된 경우에는 컨테이너 `OnPosRectChanged` 에 대 한 호출을 수행 합니다.

컨트롤의 기본 크기 조정을 변경 하려면이 함수를 재정의 합니다.

##  <a name="onsetobjectrects"></a>  COleControl::OnSetObjectRects

[IOleInPlaceObject:: SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects)호출을 구현 하기 위해 프레임 워크에서 호출 됩니다.

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>매개 변수

*lpRectPos*<br/>
컨테이너에 상대적인 컨트롤 `RECT` 의 새 위치와 크기를 나타내는 구조체에 대 한 포인터입니다.

*lpRectClip*<br/>
컨트롤을 클리핑할 사각형 `RECT` 영역을 나타내는 구조체에 대 한 포인터입니다.

### <a name="return-value"></a>반환 값

위치를 조정 하는 것이 허용 되는 경우 0이 아닙니다. 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

기본 구현은 컨트롤 창의 위치 지정 및 크기 조정을 자동으로 처리 하 고 TRUE를 반환 합니다.

이 함수의 기본 동작을 변경 하려면이 함수를 재정의 합니다.

##  <a name="onshowtoolbars"></a>  COleControl::OnShowToolBars

컨트롤이 UI 활성화 되었을 때 프레임 워크에서 호출 됩니다.

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>설명

기본 구현은 아무 작업도 수행하지 않습니다.

##  <a name="ontextchanged"></a>  COleControl::OnTextChanged

스톡 캡션 또는 텍스트 속성 값이 변경 될 때 프레임 워크에서 호출 됩니다.

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>설명

기본 구현에서는를 `InvalidateControl`호출 합니다.

이 속성이 변경 된 후 알림을 표시 하려면이 함수를 재정의 합니다.

##  <a name="onwindowlessmessage"></a>  COleControl::OnWindowlessMessage

컨테이너 `IOleInPlaceObjectWindowless::OnWindowMessage` 요청에 대 한 응답으로 프레임 워크에서 호출 됩니다.

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>매개 변수

*msg*<br/>
Windows에서 전달 하는 메시지 식별자입니다.

*wParam*<br/>
Windows에 의해 전달 됩니다. 추가 메시지 관련 정보를 지정 합니다. 이 매개 변수의 내용은 *msg* 매개 변수의 값에 따라 달라 집니다.

*lParam*<br/>
Windows에 의해 전달 됩니다. 추가 메시지 관련 정보를 지정 합니다. 이 매개 변수의 내용은 *msg* 매개 변수의 값에 따라 달라 집니다.

*plResult*<br/>
Windows 결과 코드입니다. 메시지 처리 결과를 지정 하며 보낸 메시지에 따라 다릅니다.

### <a name="return-value"></a>반환 값

성공하면 0이 아니고, 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

창 없는 컨트롤에 대 한 창 메시지를 처리 합니다. `COleControl`는 마우스 메시지 및 키보드 메시지 이외의 창 메시지에 사용 해야합니다.`OnWindowlessMessage` `COleControl`는 창 없는 OLE 개체에 대 한 마우스 캡처 및 키보드 포커스를 얻기 위해 구체적으로 [Setcapture](#setcapture) 및 [SetFocus](#setfocus) 를 제공 합니다.

창 없는 개체에는 창이 없으므로 컨테이너에서 메시지를 디스패치할 수 있도록 하는 메커니즘이 필요 합니다. 창 없는 OLE 개체는 `OnWindowMessage` `IOleInPlaceObjectWindowless` 인터페이스에서 메서드를 통해 컨테이너에서 메시지를 가져옵니다 (창 없는 지원에 대 한 [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) 확장). `OnWindowMessage`는 매개 변수를 `HWND` 사용 하지 않습니다.

##  <a name="parenttoclient"></a>  COleControl::ParentToClient

*Ppoint* 의 좌표를 클라이언트 좌표로 변환 합니다.

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>매개 변수

*lprcBounds*<br/>
컨테이너에 있는 OLE 컨트롤의 범위에 대 한 포인터입니다. 클라이언트 영역이 아니라 테두리 및 스크롤 막대를 비롯 한 전체 컨트롤의 영역입니다.

*pPoint*<br/>
컨트롤의 클라이언트 영역 좌표로 변환할 부모 (컨테이너) 지점에 대 한 포인터입니다.

*bHitTest*<br/>
지점에서 적중 테스트를 수행할지 여부를 지정 합니다.

### <a name="return-value"></a>반환 값

*BHitTest* 가 FALSE 이면 HTNOWHERE을 반환 합니다. *BHitTest* 가 TRUE 인 경우는 OLE 컨트롤의 클라이언트 영역에서 부모 (컨테이너) 포인트가 배치 위치를 반환 하며, 다음 마우스 적중 테스트 값 중 하나입니다.

- 크기 조정 테두리가 없는 창의 테두리에 있는 HTBORDER입니다.

- HTBOTTOM 창의 아래쪽 가로 테두리에 있습니다.

- HTBOTTOMLEFT는 창 테두리의 왼쪽 아래 모퉁이에 있습니다.

- 창 테두리의 오른쪽 아래 모퉁이에 있는 HTBOTTOMRIGHT입니다.

- 제목 표시줄 영역에 HTCAPTION.

- 클라이언트 영역에 HTCLIENT.

- 화면 배경이 나 windows 간의 분할 선 ( `DefWndProc` windows 함수가 오류를 나타내는 시스템 경고음을 생성 한다는 점을 제외 하 고는 HTERROR와 동일).

- 크기 상자에 HTGROWBOX.

- 가로 스크롤 막대의 HTHSCROLL입니다.

- HTLEFT 창의 왼쪽 테두리에 있습니다.

- 최대화 단추를 HTMAXBUTTON.

- 메뉴 영역에서 HTMENU.

- 최소화 단추를 HTMINBUTTON 합니다.

- 화면 배경이 나 창 간의 분할 선 HTNOWHERE.

- 최소화 단추를 HTREDUCE 합니다.

- 창의 오른쪽 테두리에 HTRIGHT.

- 크기 상자에 HTSIZE (HTGROWBOX과 동일).

- HTSYSMENU는 컨트롤 메뉴 또는 자식 창에 있는 닫기 단추를 클릭 합니다.

- HTTOP 창의 위쪽 가로 테두리에 있습니다.

- HTTOPLEFT는 창 테두리의 왼쪽 위 모퉁이에 있습니다.

- HTTOPRIGHT 창 테두리의 오른쪽 위 모퉁이에 있습니다.

- 현재 다른 창에 포함 된 창에서 HTTRANSPARENT 합니다.

- 세로 스크롤 막대에 HTVSCROLL.

- 최대화 단추를 HTZOOM.

### <a name="remarks"></a>설명

입력 된 *Ppoint* 는 부모 (컨테이너의 왼쪽 위 모퉁이)의 원점을 기준으로 합니다. 출력 *Ppoint* 는 OLE 컨트롤 (컨트롤 클라이언트 영역의 왼쪽 위 모퉁이)에 있는 클라이언트 영역의 출처를 기준으로 합니다.

##  <a name="postmodaldialog"></a>  COleControl::PostModalDialog

모달 대화 상자가 닫 혔 음을 컨테이너에 알립니다.

```
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>매개 변수

*hWndParent*<br/>
모달 대화 상자의 부모 창에 대 한 핸들입니다.

### <a name="remarks"></a>설명

모달 대화 상자를 표시 한 후이 함수를 호출 합니다. 컨테이너가에서 `PreModalDialog`사용 하지 않도록 설정 된 모든 최상위 창을 사용할 수 있도록 하려면이 함수를 호출 해야 합니다. 이 함수는에 대 `PreModalDialog`한 호출과 쌍을 이루어야 합니다.

##  <a name="premodaldialog"></a>  COleControl::PreModalDialog

모달 대화 상자가 표시 될 지를 컨테이너에 알립니다.

```
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>매개 변수

*hWndParent*<br/>
모달 대화 상자의 부모 창에 대 한 핸들입니다.

### <a name="remarks"></a>설명

모달 대화 상자를 표시 하기 전에이 함수를 호출 합니다. 컨테이너가 모든 최상위 창을 사용 하지 않도록 설정할 수 있도록이 함수를 호출 해야 합니다. 모달 대화 상자가 표시 된 후에는를 호출 `PostModalDialog`해야 합니다.

##  <a name="recreatecontrolwindow"></a>  COleControl::RecreateControlWindow

컨트롤의 창을 소멸 하 고 다시 만듭니다.

```
void RecreateControlWindow();
```

### <a name="remarks"></a>설명

이는 창의 스타일 비트를 변경 해야 하는 경우에 필요할 수 있습니다.

##  <a name="refresh"></a>  COleControl::Refresh

OLE 컨트롤을 강제로 다시 그립니다.

```
void Refresh();
```

### <a name="remarks"></a>설명

이 함수는 `COleControl` 기본 클래스에서 새로 고침 이라는 스톡 메서드로 지원 됩니다. 이렇게 하면 OLE 컨트롤의 사용자가 특정 시간에 컨트롤을 다시 그릴 수 있습니다. 이 메서드에 대 한 자세한 내용은 ActiveX 컨트롤 문서 [를 참조 하세요. 메서드](../../mfc/mfc-activex-controls-methods.md).

##  <a name="releasecapture"></a>  COleControl::ReleaseCapture

마우스 캡처를 해제 합니다.

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>반환 값

성공하면 0이 아니고, 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

컨트롤에 현재 마우스 캡처가 있는 경우 캡처가 해제 됩니다. 그렇지 않으면이 함수는 아무런 영향을 주지 않습니다.

##  <a name="releasedc"></a>  COleControl::ReleaseDC

창 없는 컨트롤의 컨테이너에 대 한 디스플레이 장치 컨텍스트를 해제 하 여 다른 응용 프로그램에서 사용할 장치 컨텍스트를 해제 합니다.

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>매개 변수

*pDC*<br/>
해제할 컨테이너 장치 컨텍스트를 식별 합니다.

### <a name="return-value"></a>반환 값

성공하면 0이 아니고, 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

응용 프로그램은 `ReleaseDC` [GetDC](#getdc)에 대 한 각 호출에 대해를 호출 해야 합니다.

##  <a name="reparentcontrolwindow"></a>  COleControl::ReparentControlWindow

컨트롤의 부모를 설정 합니다.

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>매개 변수

*hWndOuter*<br/>
컨트롤 창의 핸들입니다.

*hWndParent*<br/>
새 부모 창의 핸들입니다.

### <a name="remarks"></a>설명

컨트롤 창의 부모를 다시 설정 하려면이 함수를 호출 합니다.

##  <a name="resetstockprops"></a>  COleControl::ResetStockProps

`COleControl` 스톡 속성의 상태를 기본값으로 초기화 합니다.

```
void ResetStockProps();
```

### <a name="remarks"></a>설명

속성은 다음과 같습니다. 모양, 배경색, 테두리, 캡션, 사용, 글꼴, 전경색, hWnd 및 텍스트입니다. 스톡 속성에 대 한 자세한 내용은 [ActiveX 컨트롤: 스톡 속성](../../mfc/mfc-activex-controls-adding-stock-properties.md)추가

`COleControl::OnResetState`및 `ResetStockProps` 를사용`ResetVersion` 하 여를 재정의 하 여 컨트롤의 이진 초기화 성능을 향상 시킬 수 있습니다. 아래 예제를 참조하세요. 초기화 최적화에 대 한 자세한 내용은 ActiveX [컨트롤을 참조 하세요. 최적화](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>예제

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

##  <a name="resetversion"></a>  COleControl::ResetVersion

버전 번호를 지정 된 값으로 초기화 합니다.

```
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>매개 변수

*dwVersionDefault*<br/>
컨트롤에 할당할 버전 번호입니다.

### <a name="remarks"></a>설명

`COleControl::OnResetState`및 `ResetVersion` 를사용`ResetStockProps` 하 여를 재정의 하 여 컨트롤의 이진 초기화 성능을 향상 시킬 수 있습니다. [ResetStockProps](#resetstockprops)의 예제를 참조 하세요. 초기화 최적화에 대 한 자세한 내용은 ActiveX [컨트롤을 참조 하세요. 최적화](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="scrollwindow"></a>  COleControl::ScrollWindow

창 없는 OLE 개체가 화면에서 내부 활성 이미지 안에 영역을 스크롤할 수 있도록 허용 합니다.

```
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>매개 변수

*xAmount*<br/>
가로 스크롤의 장치 단위 크기를 지정 합니다. 이 매개 변수는 왼쪽으로 스크롤할 음수 값 이어야 합니다.

*yAmount*<br/>
세로 스크롤의 장치 단위 크기를 지정 합니다. 이 매개 변수는 위쪽으로 스크롤할 음수 값 이어야 합니다.

*lpRect*<br/>
포함 하는 창의 클라이언트 좌표로 스크롤할 OLE 개체의 클라이언트 영역 부분을 지정 하는 [Crect](../../atl-mfc-shared/reference/crect-class.md) 개체 또는 RECT 구조를 가리킵니다. *LpRect* 가 NULL 이면 전체 OLE 개체의 클라이언트 영역이 스크롤됩니다.

*lpClipRect*<br/>
클리핑할 사각형을 `CRect` 지정 하 `RECT` 는 개체 또는 구조체를 가리킵니다. 사각형 안의 픽셀만 스크롤됩니다. 사각형 외부의 비트는 *lpRect* 사각형에 있더라도 영향을 받지 않습니다. *LpClipRect* 가 NULL 이면 스크롤 사각형에서 클리핑이 수행 되지 않습니다.

##  <a name="selectfontobject"></a>  COleControl::SelectFontObject

장치 컨텍스트에서 글꼴을 선택 합니다.

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>매개 변수

*pDC*<br/>
장치 컨텍스트 개체에 대 한 포인터입니다.

*fontHolder*<br/>
선택할 글꼴을 나타내는 [Cfontholder](../../mfc/reference/cfontholder-class.md) 개체에 대 한 참조입니다.

### <a name="return-value"></a>반환 값

이전에 선택 된 글꼴에 대 한 포인터입니다. 호출자가 *Fontholder를* 사용 하는 모든 그리기 작업을 완료 한 경우 [CDC:: SelectObject](../../mfc/reference/cdc-class.md#selectobject)에 매개 변수로 전달 하 여 이전에 선택한 글꼴을 다시 선택 해야 합니다.

##  <a name="selectstockfont"></a>  COleControl::SelectStockFont

장치 컨텍스트에서 스톡 글꼴 속성을 선택 합니다.

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>매개 변수

*pDC*<br/>
글꼴이 선택 될 장치 컨텍스트입니다.

### <a name="return-value"></a>반환 값

이전에 선택한 `CFont` 개체에 대 한 포인터입니다. 완료 되 면 [CDC:: SelectObject](../../mfc/reference/cdc-class.md#selectobject) 를 사용 하 여이 글꼴을 장치 컨텍스트로 다시 선택 해야 합니다.

##  <a name="serializeextent"></a>  COleControl::SerializeExtent

컨트롤에 할당 된 디스플레이 공간의 상태를 serialize 하거나 초기화 합니다.

```
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>매개 변수

*ar*<br/>
Serialize 하거나에서 serialize 할 개체입니다.`CArchive`

### <a name="remarks"></a>설명

, `SerializeExtent` `COleControl::Serialize`및 를`SerializeVersion` 사용 하 여를 재정의 하 여 컨트롤의 이진 지 속성 성능을 향상 시킬 수 있습니다. `SerializeStockProps` 아래 예제를 참조하세요. 초기화 최적화에 대 한 자세한 내용은 ActiveX [컨트롤을 참조 하세요. 최적화](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>예제

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

##  <a name="serializestockprops"></a>  COleControl::SerializeStockProps

`COleControl` 스톡 속성의 상태를 직렬화 또는 초기화 합니다. 모양, 배경색, 테두리, 캡션, 사용, 글꼴, 전경색 및 텍스트입니다.

```
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>매개 변수

*ar*<br/>
Serialize 하거나에서 serialize 할 개체입니다.`CArchive`

### <a name="remarks"></a>설명

스톡 속성에 대 한 자세한 내용은 [ActiveX 컨트롤: 스톡 속성](../../mfc/mfc-activex-controls-adding-stock-properties.md)추가

, `SerializeStockProps` `COleControl::Serialize`및 를`SerializeVersion` 사용 하 여를 재정의 하 여 컨트롤의 이진 지 속성 성능을 향상 시킬 수 있습니다. `SerializeExtent` 예제는 [SerializeExtent](#serializeextent)에서 코드를 참조 하세요. 초기화 최적화에 대 한 자세한 내용은 ActiveX [컨트롤을 참조 하세요. 최적화](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="serializeversion"></a>  COleControl::SerializeVersion

컨트롤 버전 정보의 상태를 serialize 하거나 초기화 합니다.

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>매개 변수

*ar*<br/>
Serialize 하거나에서 serialize 할 개체입니다.`CArchive`

*dwVersionDefault*<br/>
컨트롤의 현재 버전 번호입니다.

*bConvert*<br/>
영구 데이터를 저장 하는 경우 해당 데이터를 최신 형식으로 변환할지, 아니면 로드 했을 때와 동일한 형식으로 유지할지를 나타냅니다.

### <a name="return-value"></a>반환 값

컨트롤의 버전 번호입니다. 지정 된 보관 파일이 로드 `SerializeVersion` 되는 경우 해당 보관 파일에서 로드 된 버전을 반환 합니다. 그렇지 않으면 현재 로드 된 버전을 반환 합니다.

### <a name="remarks"></a>설명

, `SerializeVersion` `COleControl::Serialize`및 를`SerializeStockProps` 사용 하 여를 재정의 하 여 컨트롤의 이진 지 속성 성능을 향상 시킬 수 있습니다. `SerializeExtent` 예제는 [SerializeExtent](#serializeextent)에서 코드를 참조 하세요. 초기화 최적화에 대 한 자세한 내용은 ActiveX [컨트롤을 참조 하세요. 최적화](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="setappearance"></a>  COleControl::SetAppearance

컨트롤의 스톡 모양 속성 값을 설정 합니다.

```
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>매개 변수

*sAppearance*<br/>
컨트롤의 모양에 사용할 **short** (VT_I2) 값입니다. 값이 0 이면 컨트롤의 모양이 flat로 설정 되 고 값이 1 이면 컨트롤의 모양이 3D로 설정 됩니다.

### <a name="remarks"></a>설명

스톡 속성에 대 한 자세한 내용은 [ActiveX 컨트롤: 속성](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setbackcolor"></a>  COleControl::SetBackColor

컨트롤의 스톡 BackColor 속성 값을 설정 합니다.

```
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>매개 변수

*dwBackColor*<br/>
컨트롤의 배경 그리기에 사용할 OLE_COLOR 값입니다.

### <a name="remarks"></a>설명

이 속성 및 기타 관련 속성을 사용 하는 방법에 대 한 자세한 [내용은 ActiveX 컨트롤 문서를 참조 하세요. 속성](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setborderstyle"></a>  COleControl::SetBorderStyle

컨트롤의 스톡 BorderStyle 속성 값을 설정 합니다.

```
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>매개 변수

*sBorderStyle*<br/>
컨트롤의 새 테두리 스타일입니다. 0은 테두리가 없고 1은 표준 테두리를 나타냅니다.

### <a name="remarks"></a>설명

그런 다음 컨트롤 창이 다시 만들어지고 `OnBorderStyleChanged` 호출 됩니다.

##  <a name="setcapture"></a>  COleControl::SetCapture

컨트롤의 컨테이너 창이 컨트롤을 대신 하 여 마우스 캡처를 소유 하도록 합니다.

```
CWnd* SetCapture();
```

### <a name="return-value"></a>반환 값

마우스 입력을 이전 `CWnd` 에 받은 창 개체에 대 한 포인터입니다.

### <a name="remarks"></a>설명

컨트롤이 활성화 되 고 창이 없는 경우이 함수를 사용 하면 컨트롤의 컨테이너 창에서 컨트롤을 대신 하 여 마우스 캡처를 소유 하 게 됩니다. 그렇지 않으면이 함수는 컨트롤 자체에서 마우스 캡처를 소유 하 게 됩니다 (와 `CWnd::SetCapture`동일).

##  <a name="setcontrolsize"></a>  COleControl::SetControlSize

OLE 컨트롤 창의 크기를 설정 하 고 컨트롤 사이트에서 변경 하 고 있음을 컨테이너에 알립니다.

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>매개 변수

*cx*<br/>
컨트롤의 새 너비 (픽셀)를 지정 합니다.

*cy*<br/>
컨트롤의 새 높이 (픽셀)를 지정 합니다.

### <a name="return-value"></a>반환 값

호출에 성공 하면 0이 아닌 값입니다. 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

이 함수는 컨트롤의 생성자에서 사용 하면 안 됩니다.

컨트롤 창의 모든 좌표는 컨트롤의 왼쪽 위 모퉁이를 기준으로 합니다.

##  <a name="setenabled"></a>  COleControl::SetEnabled

컨트롤의 스톡 Enabled 속성 값을 설정 합니다.

```
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>매개 변수

*bEnabled*<br/>
컨트롤을 사용할 수 있으면 TRUE이 고, 그렇지 않으면입니다. 그렇지 않으면 FALSE입니다.

### <a name="remarks"></a>설명

이 속성을 `OnEnabledChange` 설정한 후가 호출 됩니다.

##  <a name="setfocus"></a>  COleControl::SetFocus

컨트롤의 컨테이너 창이 컨트롤의 대신 입력 포커스를 소유 하 게 합니다.

```
CWnd* SetFocus();
```

### <a name="return-value"></a>반환 값

이전에 입력 포커스가 `CWnd` 있던 창 개체에 대 한 포인터 이거나, 이러한 창이 없으면 NULL입니다.

### <a name="remarks"></a>설명

컨트롤이 활성화 되 고 창이 없는 경우이 함수를 사용 하면 컨트롤의 컨테이너 창이 컨트롤을 대신 하 여 입력 포커스를 소유 하 게 됩니다. 입력 포커스는 키보드 입력을 컨테이너의 창으로 전달 하 고, 컨테이너는를 호출 `SetFocus`하는 OLE 개체에 모든 후속 키보드 메시지를 디스패치합니다. 이전에 입력 포커스가 있던 모든 창이 손실 됩니다.

컨트롤이 창이 없는 경우이 함수는 컨트롤 자체에서 입력 포커스를 소유 하 게 합니다 (와 `CWnd::SetFocus`동일).

##  <a name="setfont"></a>  COleControl::SetFont

컨트롤의 스톡 글꼴 속성을 설정 합니다.

```
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>매개 변수

*pFontDisp*<br/>
글꼴 디스패치 인터페이스에 대 한 포인터입니다.

##  <a name="setforecolor"></a>  COleControl::SetForeColor

컨트롤의 스톡 ForeColor 속성 값을 설정 합니다.

```
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>매개 변수

*dwForeColor*<br/>
컨트롤의 전경 그리기에 사용할 OLE_COLOR 값입니다.

### <a name="remarks"></a>설명

이 속성 및 기타 관련 속성을 사용 하는 방법에 대 한 자세한 [내용은 ActiveX 컨트롤 문서를 참조 하세요. 속성](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setinitialdataformats"></a>  COleControl::SetInitialDataFormats

컨트롤에서 지 원하는 데이터 형식 목록을 초기화 하기 위해 프레임 워크에서 호출 됩니다.

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>설명

기본 구현에서는 다음과 같은 두 가지 형식을 지정 합니다. CF_METAFILEPICT 및 영구 속성 집합이 있습니다.

##  <a name="setinitialsize"></a>  COleControl::SetInitialSize

컨테이너에 처음 표시 될 때 OLE 컨트롤의 크기를 설정 합니다.

```
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>매개 변수

*cx*<br/>
OLE 컨트롤의 초기 너비 (픽셀)입니다.

*cy*<br/>
OLE 컨트롤의 초기 높이 (픽셀)입니다.

### <a name="remarks"></a>설명

생성자에서이 함수를 호출 하 여 컨트롤의 초기 크기를 설정 합니다. 초기 크기는 장치 단위나 픽셀 단위로 측정 됩니다. 이 호출은 컨트롤의 생성자에서 수행 하는 것이 좋습니다.

##  <a name="setmodifiedflag"></a>  COleControl::SetModifiedFlag

컨트롤의 수정 된 상태를 변경 합니다.

```
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>매개 변수

*bModified*<br/>
컨트롤의 수정 된 플래그에 대 한 새 값입니다. TRUE는 컨트롤의 상태가 수정 되었음을 나타냅니다. FALSE는 컨트롤의 상태가 방금 저장 되었음을 나타냅니다.

### <a name="remarks"></a>설명

컨트롤의 영구 상태에 영향을 주는 변경이 발생할 때마다이 함수를 호출 합니다. 예를 들어, 영구 속성의 값이 변경 되는 경우 *Bmodified* **TRUE**를 사용 하 여이 함수를 호출 합니다.

##  <a name="setnotpermitted"></a>  COleControl::SetNotPermitted

편집 요청이 실패 했음을 나타냅니다.

```
void SetNotPermitted();
```

### <a name="remarks"></a>설명

가 실패할 경우 `BoundPropertyRequestEdit` 이 함수를 호출 합니다. 이 함수는 설정 작업이 허용 되지 `COleDispScodeException` 않았음을 나타내기 위해 형식의 예외를 throw 합니다.

##  <a name="setnotsupported"></a>  COleControl::SetNotSupported

사용자가 컨트롤의 속성 값을 수정 하지 못하도록 합니다.

```
void SetNotSupported();
```

### <a name="remarks"></a>설명

컨트롤의 사용자가 속성 값을 수정 하는 것이 지원 되지 않는 모든 속성의 Set 함수 대신이 함수를 호출 합니다. 한 가지 예는 읽기 전용 속성입니다.

##  <a name="setrectincontainer"></a>  COleControl::SetRectInContainer

장치 단위로 표현 된 컨테이너를 기준으로 컨트롤 사각형의 좌표를 설정 합니다.

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>매개 변수

*lpRect*<br/>
컨테이너에 상대적인 컨트롤의 새 좌표가 포함 된 사각형에 대 한 포인터입니다.

### <a name="return-value"></a>반환 값

호출에 성공 하면 0이 아닌 값입니다. 그렇지 않으면 0입니다.

### <a name="remarks"></a>설명

컨트롤이 열려 있으면 크기가 조정 됩니다. 그렇지 않으면 컨테이너의 `OnPosRectChanged` 함수가 호출 됩니다.

##  <a name="settext"></a>  COleControl::SetText

컨트롤의 스톡 캡션 또는 텍스트 속성의 값을 설정 합니다.

```
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>매개 변수

*pszText*<br/>
문자열에 대 한 포인터입니다.

### <a name="remarks"></a>설명

스톡 캡션과 텍스트 속성은 모두 동일한 값에 매핑됩니다. 즉, 두 속성 중 하나를 변경 하면 두 속성이 모두 자동으로 변경 됩니다. 일반적으로 컨트롤은 스톡 캡션 또는 텍스트 속성 중 하나만 지원 해야 합니다.

##  <a name="throwerror"></a>  COleControl::ThrowError

컨트롤에서 오류가 발생 했음을 알립니다.

```
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);

void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>매개 변수

*sc*<br/>
보고할 상태 코드 값입니다. 가능한 코드의 전체 목록은 ActiveX 컨트롤 문서 [를 참조 하세요. 고급 항목](../../mfc/mfc-activex-controls-advanced-topics.md)

*nDescriptionID*<br/>
보고할 예외의 문자열 리소스 ID입니다.

*nHelpID*<br/>
보고할 토픽의 도움말 ID입니다.

*pszDescription*<br/>
보고할 예외에 대 한 설명이 포함 된 문자열입니다.

### <a name="remarks"></a>설명

이 함수는 OLE 속성의 Get 또는 Set 함수 내에서 또는 OLE 자동화 메서드를 구현 하는 경우에만 호출 해야 합니다. 다른 시간에 발생 한 오류를 표시 해야 하는 경우에는 스톡 오류 이벤트를 발생 시켜야 합니다.

##  <a name="transformcoords"></a>  COleControl::TransformCoords

HIMETRIC unit과 컨테이너의 기본 단위 간에 좌표 값을 변환 합니다.

```
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>매개 변수

*lpptlHimetric*<br/>
HIMETRIC unit의 `POINTL` 좌표가 포함 된 구조체에 대 한 포인터입니다.

*lpptfContainer*<br/>
컨테이너 단위 크기 `POINTF` 의 좌표가 포함 된 구조체에 대 한 포인터입니다.

*flags*<br/>
다음 값의 조합입니다.

- 컨테이너의 위치를 XFORMCOORDS_POSITION 합니다.

- 컨테이너의 크기를 XFORMCOORDS_SIZE 합니다.

- XFORMCOORDS_HIMETRICTOCONTAINER HIMETRIC units를 컨테이너의 단위로 변환 합니다.

- XFORMCOORDS_CONTAINERTOHIMETRIC 컨테이너의 단위를 HIMETRIC units로 변환 합니다.

### <a name="remarks"></a>설명

처음 두 플래그 인 XFORMCOORDS_POSITION 및 XFORMCOORDS_SIZE는 좌표를 위치 또는 크기로 처리할지 여부를 나타냅니다. 나머지 두 플래그는 변환 방향을 표시 합니다.

##  <a name="translatecolor"></a>  COleControl::TranslateColor

OLE_COLOR 데이터 형식에서 [Colorref](/windows/win32/gdi/colorref) 데이터 형식으로 색 값을 변환 합니다.

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>매개 변수

*clrColor*<br/>
OLE_COLOR 데이터 형식입니다. 자세한 내용은 Windows [OleTranslateColor](/windows/win32/api/olectl/nf-olectl-oletranslatecolor) 함수를 참조 하세요.

*hpal*<br/>
선택적인 색상표에 대 한 핸들입니다. NULL 일 수 있습니다.

### <a name="return-value"></a>반환 값

장치에서 나타낼 수 있는 *clrcolor* 값에 가장 가까운 단색을 정의 하는 RGB (빨강, 녹색, 파랑) 32 비트 색 값입니다.

### <a name="remarks"></a>설명

이 함수는 속성을 [CDC](../../mfc/reference/cdc-class.md) 멤버 함수에서 사용 하는 colorref 형식으로 변환 하는 데 유용 합니다.

##  <a name="willambientsbevalidduringload"></a>  COleControl::WillAmbientsBeValidDuringLoad

이후에 영구 상태에서 로드 되는 경우 컨트롤에서 앰비언트 속성의 값을 기본값으로 사용할지 여부를 결정 합니다.

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>반환 값

0이 아닌 값은 앰비언트 속성이 유효 함을 나타냅니다. 그렇지 않으면 앰비언트 속성이 유효 하지 않습니다.

### <a name="remarks"></a>설명

일부 컨테이너에서는의 `COleControl::DoPropExchange`재정의를 초기 호출 하는 동안 컨트롤에 앰비언트 속성에 대 한 액세스 권한이 없을 수 있습니다. 이는 컨테이너에서 [IOleObject:: SetClientSite](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setclientsite) 를 호출 하기 전에 [IPersistStreamInit:: load](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-load) 또는 [IPersistStorage:: load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) 를 호출 하는 경우 (즉, OLEMISC_SETCLIENTSITEFIRST 상태 비트가 인식 되지 않는 경우)입니다.

##  <a name="windowproc"></a>  COleControl::WindowProc

`COleControl` 개체에 대 한 Windows 프로시저를 제공 합니다.

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>매개 변수

*message*<br/>
처리할 Windows 메시지를 지정 합니다.

*wParam*<br/>
메시지 처리에 사용 되는 추가 정보를 제공 합니다. 매개 변수 값은 메시지에 따라 다릅니다.

*lParam*<br/>
메시지 처리에 사용 되는 추가 정보를 제공 합니다. 매개 변수 값은 메시지에 따라 다릅니다.

### <a name="return-value"></a>반환 값

발송 된 메시지의 반환 값입니다.

### <a name="remarks"></a>설명

이 함수를 호출 하 여 컨트롤의 메시지 맵을 통해 특정 메시지를 디스패치합니다.

## <a name="see-also"></a>참고자료

[MFC 샘플 CIRC3](../../overview/visual-cpp-samples.md)<br/>
[MFC 샘플 TESTHELP](../../overview/visual-cpp-samples.md)<br/>
[COlePropertyPage 클래스](../../mfc/reference/colepropertypage-class.md)<br/>
[CWnd 클래스](../../mfc/reference/cwnd-class.md)<br/>
[계층 구조 차트](../../mfc/hierarchy-chart.md)<br/>
[CFontHolder 클래스](../../mfc/reference/cfontholder-class.md)<br/>
[CPictureHolder 클래스](../../mfc/reference/cpictureholder-class.md)<br/>
